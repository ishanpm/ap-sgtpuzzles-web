(()=>{var e={456:(e,t,n)=>{"use strict";n.r(t),n.d(t,{config:()=>i});const i={environment:"production",enableDebug:!1,defaultHost:"archipelago.gg"}},705:(e,t,n)=>{"use strict";n.d(t,{A:()=>Jn});var i,s,r,o,a=!1,l=!1,c=[],u=-1;function d(e){let t=c.indexOf(e);-1!==t&&t>u&&c.splice(t,1)}function h(){a=!1,l=!0;for(let e=0;e<c.length;e++)c[e](),u=e;c.length=0,u=-1,l=!1}var p=!0;function f(e){s=e}function m(e,t){let n,i=!0,o=s((()=>{let s=e();JSON.stringify(s),i?n=s:queueMicrotask((()=>{t(s,n),n=s})),i=!1}));return()=>r(o)}var g=[],_=[],v=[];function y(e,t){"function"==typeof t?(e._x_cleanups||(e._x_cleanups=[]),e._x_cleanups.push(t)):(t=e,_.push(t))}function b(e){g.push(e)}function w(e,t,n){e._x_attributeCleanups||(e._x_attributeCleanups={}),e._x_attributeCleanups[t]||(e._x_attributeCleanups[t]=[]),e._x_attributeCleanups[t].push(n)}function x(e,t){e._x_attributeCleanups&&Object.entries(e._x_attributeCleanups).forEach((([n,i])=>{(void 0===t||t.includes(n))&&(i.forEach((e=>e())),delete e._x_attributeCleanups[n])}))}var k=new MutationObserver(L),z=!1;function S(){k.observe(document,{subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0}),z=!0}function P(){!function(){let e=k.takeRecords();C.push((()=>e.length>0&&L(e)));let t=C.length;queueMicrotask((()=>{if(C.length===t)for(;C.length>0;)C.shift()()}))}(),k.disconnect(),z=!1}var C=[];function E(e){if(!z)return e();P();let t=e();return S(),t}var A=!1,j=[];function L(e){if(A)return void(j=j.concat(e));let t=new Set,n=new Set,i=new Map,s=new Map;for(let r=0;r<e.length;r++)if(!e[r].target._x_ignoreMutationObserver&&("childList"===e[r].type&&(e[r].addedNodes.forEach((e=>1===e.nodeType&&t.add(e))),e[r].removedNodes.forEach((e=>1===e.nodeType&&n.add(e)))),"attributes"===e[r].type)){let t=e[r].target,n=e[r].attributeName,o=e[r].oldValue,a=()=>{i.has(t)||i.set(t,[]),i.get(t).push({name:n,value:t.getAttribute(n)})},l=()=>{s.has(t)||s.set(t,[]),s.get(t).push(n)};t.hasAttribute(n)&&null===o?a():t.hasAttribute(n)?(l(),a()):l()}s.forEach(((e,t)=>{x(t,e)})),i.forEach(((e,t)=>{g.forEach((n=>n(t,e)))}));for(let e of n)t.has(e)||_.forEach((t=>t(e)));t.forEach((e=>{e._x_ignoreSelf=!0,e._x_ignore=!0}));for(let e of t)n.has(e)||e.isConnected&&(delete e._x_ignoreSelf,delete e._x_ignore,v.forEach((t=>t(e))),e._x_ignore=!0,e._x_ignoreSelf=!0);t.forEach((e=>{delete e._x_ignoreSelf,delete e._x_ignore})),t=null,n=null,i=null,s=null}function O(e){return T(I(e))}function $(e,t,n){return e._x_dataStack=[t,...I(n||e)],()=>{e._x_dataStack=e._x_dataStack.filter((e=>e!==t))}}function I(e){return e._x_dataStack?e._x_dataStack:"function"==typeof ShadowRoot&&e instanceof ShadowRoot?I(e.host):e.parentNode?I(e.parentNode):[]}function T(e){return new Proxy({objects:e},M)}var M={ownKeys:({objects:e})=>Array.from(new Set(e.flatMap((e=>Object.keys(e))))),has:({objects:e},t)=>t!=Symbol.unscopables&&e.some((e=>Object.prototype.hasOwnProperty.call(e,t)||Reflect.has(e,t))),get:({objects:e},t,n)=>"toJSON"==t?N:Reflect.get(e.find((e=>Reflect.has(e,t)))||{},t,n),set({objects:e},t,n,i){const s=e.find((e=>Object.prototype.hasOwnProperty.call(e,t)))||e[e.length-1],r=Object.getOwnPropertyDescriptor(s,t);return r?.set&&r?.get?r.set.call(i,n)||!0:Reflect.set(s,t,n)}};function N(){return Reflect.ownKeys(this).reduce(((e,t)=>(e[t]=Reflect.get(this,t),e)),{})}function D(e){let t=(n,i="")=>{Object.entries(Object.getOwnPropertyDescriptors(n)).forEach((([s,{value:r,enumerable:o}])=>{if(!1===o||void 0===r)return;if("object"==typeof r&&null!==r&&r.__v_skip)return;let a=""===i?s:`${i}.${s}`;var l;"object"==typeof r&&null!==r&&r._x_interceptor?n[s]=r.initialize(e,a,s):"object"!=typeof(l=r)||Array.isArray(l)||null===l||r===n||r instanceof Element||t(r,a)}))};return t(e)}function R(e,t=()=>{}){let n={initialValue:void 0,_x_interceptor:!0,initialize(t,n,i){return e(this.initialValue,(()=>function(e,t){return t.split(".").reduce(((e,t)=>e[t]),e)}(t,n)),(e=>F(t,n,e)),n,i)}};return t(n),e=>{if("object"==typeof e&&null!==e&&e._x_interceptor){let t=n.initialize.bind(n);n.initialize=(i,s,r)=>{let o=e.initialize(i,s,r);return n.initialValue=o,t(i,s,r)}}else n.initialValue=e;return n}}function F(e,t,n){if("string"==typeof t&&(t=t.split(".")),1!==t.length){if(0===t.length)throw error;return e[t[0]]||(e[t[0]]={}),F(e[t[0]],t.slice(1),n)}e[t[0]]=n}var U={};function B(e,t){U[e]=t}function W(e,t){return Object.entries(U).forEach((([n,i])=>{let s=null;Object.defineProperty(e,`$${n}`,{get:()=>i(t,function(){if(s)return s;{let[e,n]=ce(t);return s={interceptor:R,...e},y(t,n),s}}()),enumerable:!1})})),e}function V(e,t,n,...i){try{return n(...i)}catch(n){q(n,e,t)}}function q(e,t,n=void 0){e=Object.assign(e??{message:"No error message given."},{el:t,expression:n}),console.warn(`Alpine Expression Error: ${e.message}\n\n${n?'Expression: "'+n+'"\n\n':""}`,t),setTimeout((()=>{throw e}),0)}var H=!0;function G(e){let t=H;H=!1;let n=e();return H=t,n}function K(e,t,n={}){let i;return J(e,t)((e=>i=e),n),i}function J(...e){return Z(...e)}var Z=Y;function Y(e,t){let n={};W(n,e);let i=[n,...I(e)],s="function"==typeof t?function(e,t){return(n=()=>{},{scope:i={},params:s=[]}={})=>{Q(n,t.apply(T([i,...e]),s))}}(i,t):function(e,t,n){let i=function(e,t){if(X[e])return X[e];let n=Object.getPrototypeOf((async function(){})).constructor,i=/^[\n\s]*if.*\(.*\)/.test(e.trim())||/^(let|const)\s/.test(e.trim())?`(async()=>{ ${e} })()`:e;let s=(()=>{try{let t=new n(["__self","scope"],`with (scope) { __self.result = ${i} }; __self.finished = true; return __self.result;`);return Object.defineProperty(t,"name",{value:`[Alpine] ${e}`}),t}catch(n){return q(n,t,e),Promise.resolve()}})();return X[e]=s,s}(t,n);return(s=()=>{},{scope:r={},params:o=[]}={})=>{i.result=void 0,i.finished=!1;let a=T([r,...e]);if("function"==typeof i){let e=i(i,a).catch((e=>q(e,n,t)));i.finished?(Q(s,i.result,a,o,n),i.result=void 0):e.then((e=>{Q(s,e,a,o,n)})).catch((e=>q(e,n,t))).finally((()=>i.result=void 0))}}}(i,t,e);return V.bind(null,e,t,s)}var X={};function Q(e,t,n,i,s){if(H&&"function"==typeof t){let r=t.apply(n,i);r instanceof Promise?r.then((t=>Q(e,t,n,i))).catch((e=>q(e,s,t))):e(r)}else"object"==typeof t&&t instanceof Promise?t.then((t=>e(t))):e(t)}var ee="x-";function te(e=""){return ee+e}var ne={};function ie(e,t){return ne[e]=t,{before(t){if(!ne[t])return void console.warn(String.raw`Cannot find directive \`${t}\`. \`${e}\` will use the default order of execution`);const n=_e.indexOf(t);_e.splice(n>=0?n:_e.indexOf("DEFAULT"),0,e)}}}function se(e,t,n){if(t=Array.from(t),e._x_virtualDirectives){let n=Object.entries(e._x_virtualDirectives).map((([e,t])=>({name:e,value:t}))),i=re(n);n=n.map((e=>i.find((t=>t.name===e.name))?{name:`x-bind:${e.name}`,value:`"${e.value}"`}:e)),t=t.concat(n)}let i={},s=t.map(de(((e,t)=>i[e]=t))).filter(fe).map(function(e,t){return({name:n,value:i})=>{let s=n.match(me()),r=n.match(/:([a-zA-Z0-9\-_:]+)/),o=n.match(/\.[^.\]]+(?=[^\]]*$)/g)||[],a=t||e[n]||n;return{type:s?s[1]:null,value:r?r[1]:null,modifiers:o.map((e=>e.replace(".",""))),expression:i,original:a}}}(i,n)).sort(ve);return s.map((t=>function(e,t){let n=ne[t.type]||(()=>{}),[i,s]=ce(e);w(e,t.original,s);let r=()=>{e._x_ignore||e._x_ignoreSelf||(n.inline&&n.inline(e,t,i),n=n.bind(n,e,t,i),oe?ae.get(le).push(n):n())};return r.runCleanups=s,r}(e,t)))}function re(e){return Array.from(e).map(de()).filter((e=>!fe(e)))}var oe=!1,ae=new Map,le=Symbol();function ce(e){let t=[],[n,i]=function(e){let t=()=>{};return[n=>{let i=s(n);return e._x_effects||(e._x_effects=new Set,e._x_runEffects=()=>{e._x_effects.forEach((e=>e()))}),e._x_effects.add(i),t=()=>{void 0!==i&&(e._x_effects.delete(i),r(i))},i},()=>{t()}]}(e);return t.push(i),[{Alpine:pt,effect:n,cleanup:e=>t.push(e),evaluateLater:J.bind(J,e),evaluate:K.bind(K,e)},()=>t.forEach((e=>e()))]}var ue=(e,t)=>({name:n,value:i})=>(n.startsWith(e)&&(n=n.replace(e,t)),{name:n,value:i});function de(e=()=>{}){return({name:t,value:n})=>{let{name:i,value:s}=he.reduce(((e,t)=>t(e)),{name:t,value:n});return i!==t&&e(i,t),{name:i,value:s}}}var he=[];function pe(e){he.push(e)}function fe({name:e}){return me().test(e)}var me=()=>new RegExp(`^${ee}([^:^.]+)\\b`),ge="DEFAULT",_e=["ignore","ref","data","id","anchor","bind","init","for","model","modelable","transition","show","if",ge,"teleport"];function ve(e,t){let n=-1===_e.indexOf(e.type)?ge:e.type,i=-1===_e.indexOf(t.type)?ge:t.type;return _e.indexOf(n)-_e.indexOf(i)}function ye(e,t,n={}){e.dispatchEvent(new CustomEvent(t,{detail:n,bubbles:!0,composed:!0,cancelable:!0}))}function be(e,t){if("function"==typeof ShadowRoot&&e instanceof ShadowRoot)return void Array.from(e.children).forEach((e=>be(e,t)));let n=!1;if(t(e,(()=>n=!0)),n)return;let i=e.firstElementChild;for(;i;)be(i,t),i=i.nextElementSibling}function we(e,...t){console.warn(`Alpine Warning: ${e}`,...t)}var xe=!1,ke=[],ze=[];function Se(){return ke.map((e=>e()))}function Pe(){return ke.concat(ze).map((e=>e()))}function Ce(e){ke.push(e)}function Ee(e){ze.push(e)}function Ae(e,t=!1){return je(e,(e=>{if((t?Pe():Se()).some((t=>e.matches(t))))return!0}))}function je(e,t){if(e){if(t(e))return e;if(e._x_teleportBack&&(e=e._x_teleportBack),e.parentElement)return je(e.parentElement,t)}}var Le=[];function Oe(e,t=be,n=()=>{}){!function(){oe=!0;let i=Symbol();le=i,ae.set(i,[]);let s=()=>{for(;ae.get(i).length;)ae.get(i).shift()();ae.delete(i)};t(e,((e,t)=>{n(e,t),Le.forEach((n=>n(e,t))),se(e,e.attributes).forEach((e=>e())),e._x_ignore&&t()})),oe=!1,s()}()}function $e(e,t=be){t(e,(e=>{x(e),function(e){if(e._x_cleanups)for(;e._x_cleanups.length;)e._x_cleanups.pop()()}(e)}))}var Ie=[],Te=!1;function Me(e=()=>{}){return queueMicrotask((()=>{Te||setTimeout((()=>{Ne()}))})),new Promise((t=>{Ie.push((()=>{e(),t()}))}))}function Ne(){for(Te=!1;Ie.length;)Ie.shift()()}function De(e,t){return Array.isArray(t)?Re(e,t.join(" ")):"object"==typeof t&&null!==t?function(e,t){let n=e=>e.split(" ").filter(Boolean),i=Object.entries(t).flatMap((([e,t])=>!!t&&n(e))).filter(Boolean),s=Object.entries(t).flatMap((([e,t])=>!t&&n(e))).filter(Boolean),r=[],o=[];return s.forEach((t=>{e.classList.contains(t)&&(e.classList.remove(t),o.push(t))})),i.forEach((t=>{e.classList.contains(t)||(e.classList.add(t),r.push(t))})),()=>{o.forEach((t=>e.classList.add(t))),r.forEach((t=>e.classList.remove(t)))}}(e,t):"function"==typeof t?De(e,t()):Re(e,t)}function Re(e,t){return t=!0===t?t="":t||"",n=t.split(" ").filter((t=>!e.classList.contains(t))).filter(Boolean),e.classList.add(...n),()=>{e.classList.remove(...n)};var n}function Fe(e,t){return"object"==typeof t&&null!==t?function(e,t){let n={};return Object.entries(t).forEach((([t,i])=>{n[t]=e.style[t],t.startsWith("--")||(t=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()),e.style.setProperty(t,i)})),setTimeout((()=>{0===e.style.length&&e.removeAttribute("style")})),()=>{Fe(e,n)}}(e,t):function(e,t){let n=e.getAttribute("style",t);return e.setAttribute("style",t),()=>{e.setAttribute("style",n||"")}}(e,t)}function Ue(e,t=()=>{}){let n=!1;return function(){n?t.apply(this,arguments):(n=!0,e.apply(this,arguments))}}function Be(e,t,n={}){e._x_transition||(e._x_transition={enter:{during:n,start:n,end:n},leave:{during:n,start:n,end:n},in(n=()=>{},i=()=>{}){Ve(e,t,{during:this.enter.during,start:this.enter.start,end:this.enter.end},n,i)},out(n=()=>{},i=()=>{}){Ve(e,t,{during:this.leave.during,start:this.leave.start,end:this.leave.end},n,i)}})}function We(e){let t=e.parentNode;if(t)return t._x_hidePromise?t:We(t)}function Ve(e,t,{during:n,start:i,end:s}={},r=()=>{},o=()=>{}){if(e._x_transitioning&&e._x_transitioning.cancel(),0===Object.keys(n).length&&0===Object.keys(i).length&&0===Object.keys(s).length)return r(),void o();let a,l,c;!function(e,t){let n,i,s,r=Ue((()=>{E((()=>{n=!0,i||t.before(),s||(t.end(),Ne()),t.after(),e.isConnected&&t.cleanup(),delete e._x_transitioning}))}));e._x_transitioning={beforeCancels:[],beforeCancel(e){this.beforeCancels.push(e)},cancel:Ue((function(){for(;this.beforeCancels.length;)this.beforeCancels.shift()();r()})),finish:r},E((()=>{t.start(),t.during()})),Te=!0,requestAnimationFrame((()=>{if(n)return;let r=1e3*Number(getComputedStyle(e).transitionDuration.replace(/,.*/,"").replace("s","")),o=1e3*Number(getComputedStyle(e).transitionDelay.replace(/,.*/,"").replace("s",""));0===r&&(r=1e3*Number(getComputedStyle(e).animationDuration.replace("s",""))),E((()=>{t.before()})),i=!0,requestAnimationFrame((()=>{n||(E((()=>{t.end()})),Ne(),setTimeout(e._x_transitioning.finish,r+o),s=!0)}))}))}(e,{start(){a=t(e,i)},during(){l=t(e,n)},before:r,end(){a(),c=t(e,s)},after:o,cleanup(){l(),c()}})}function qe(e,t,n){if(-1===e.indexOf(t))return n;const i=e[e.indexOf(t)+1];if(!i)return n;if("scale"===t&&isNaN(i))return n;if("duration"===t||"delay"===t){let e=i.match(/([0-9]+)ms/);if(e)return e[1]}return"origin"===t&&["top","right","left","center","bottom"].includes(e[e.indexOf(t)+2])?[i,e[e.indexOf(t)+2]].join(" "):i}ie("transition",((e,{value:t,modifiers:n,expression:i},{evaluate:s})=>{"function"==typeof i&&(i=s(i)),!1!==i&&(i&&"boolean"!=typeof i?function(e,t,n){Be(e,De,""),{enter:t=>{e._x_transition.enter.during=t},"enter-start":t=>{e._x_transition.enter.start=t},"enter-end":t=>{e._x_transition.enter.end=t},leave:t=>{e._x_transition.leave.during=t},"leave-start":t=>{e._x_transition.leave.start=t},"leave-end":t=>{e._x_transition.leave.end=t}}[n](t)}(e,i,t):function(e,t,n){Be(e,Fe);let i=!t.includes("in")&&!t.includes("out")&&!n,s=i||t.includes("in")||["enter"].includes(n),r=i||t.includes("out")||["leave"].includes(n);t.includes("in")&&!i&&(t=t.filter(((e,n)=>n<t.indexOf("out")))),t.includes("out")&&!i&&(t=t.filter(((e,n)=>n>t.indexOf("out"))));let o=!t.includes("opacity")&&!t.includes("scale"),a=o||t.includes("opacity")?0:1,l=o||t.includes("scale")?qe(t,"scale",95)/100:1,c=qe(t,"delay",0)/1e3,u=qe(t,"origin","center"),d="opacity, transform",h=qe(t,"duration",150)/1e3,p=qe(t,"duration",75)/1e3,f="cubic-bezier(0.4, 0.0, 0.2, 1)";s&&(e._x_transition.enter.during={transformOrigin:u,transitionDelay:`${c}s`,transitionProperty:d,transitionDuration:`${h}s`,transitionTimingFunction:f},e._x_transition.enter.start={opacity:a,transform:`scale(${l})`},e._x_transition.enter.end={opacity:1,transform:"scale(1)"}),r&&(e._x_transition.leave.during={transformOrigin:u,transitionDelay:`${c}s`,transitionProperty:d,transitionDuration:`${p}s`,transitionTimingFunction:f},e._x_transition.leave.start={opacity:1,transform:"scale(1)"},e._x_transition.leave.end={opacity:a,transform:`scale(${l})`})}(e,n,t))})),window.Element.prototype._x_toggleAndCascadeWithTransitions=function(e,t,n,i){const s="visible"===document.visibilityState?requestAnimationFrame:setTimeout;let r=()=>s(n);t?e._x_transition&&(e._x_transition.enter||e._x_transition.leave)?e._x_transition.enter&&(Object.entries(e._x_transition.enter.during).length||Object.entries(e._x_transition.enter.start).length||Object.entries(e._x_transition.enter.end).length)?e._x_transition.in(n):r():e._x_transition?e._x_transition.in(n):r():(e._x_hidePromise=e._x_transition?new Promise(((t,n)=>{e._x_transition.out((()=>{}),(()=>t(i))),e._x_transitioning&&e._x_transitioning.beforeCancel((()=>n({isFromCancelledTransition:!0})))})):Promise.resolve(i),queueMicrotask((()=>{let t=We(e);t?(t._x_hideChildren||(t._x_hideChildren=[]),t._x_hideChildren.push(e)):s((()=>{let t=e=>{let n=Promise.all([e._x_hidePromise,...(e._x_hideChildren||[]).map(t)]).then((([e])=>e?.()));return delete e._x_hidePromise,delete e._x_hideChildren,n};t(e).catch((e=>{if(!e.isFromCancelledTransition)throw e}))}))})))};var He=!1;function Ge(e,t=()=>{}){return(...n)=>He?t(...n):e(...n)}var Ke=[];function Je(e){Ke.push(e)}var Ze=!1;function Ye(e){let t=s;f(((e,n)=>{let i=t(e);return r(i),()=>{}})),e(),f(t)}function Xe(e,t,n,s=[]){switch(e._x_bindings||(e._x_bindings=i({})),e._x_bindings[t]=n,t=s.includes("camel")?t.toLowerCase().replace(/-(\w)/g,((e,t)=>t.toUpperCase())):t){case"value":!function(e,t){if("radio"===e.type)void 0===e.attributes.value&&(e.value=t),window.fromModel&&(e.checked="boolean"==typeof t?tt(e.value)===t:et(e.value,t));else if("checkbox"===e.type)Number.isInteger(t)?e.value=t:Array.isArray(t)||"boolean"==typeof t||[null,void 0].includes(t)?Array.isArray(t)?e.checked=t.some((t=>et(t,e.value))):e.checked=!!t:e.value=String(t);else if("SELECT"===e.tagName)!function(e,t){const n=[].concat(t).map((e=>e+""));Array.from(e.options).forEach((e=>{e.selected=n.includes(e.value)}))}(e,t);else{if(e.value===t)return;e.value=void 0===t?"":t}}(e,n);break;case"style":!function(e,t){e._x_undoAddedStyles&&e._x_undoAddedStyles(),e._x_undoAddedStyles=Fe(e,t)}(e,n);break;case"class":!function(e,t){e._x_undoAddedClasses&&e._x_undoAddedClasses(),e._x_undoAddedClasses=De(e,t)}(e,n);break;case"selected":case"checked":!function(e,t,n){Qe(e,t,n),function(e,t,n){e[t]!==n&&(e[t]=n)}(e,t,n)}(e,t,n);break;default:Qe(e,t,n)}}function Qe(e,t,n){[null,void 0,!1].includes(n)&&function(e){return!["aria-pressed","aria-checked","aria-expanded","aria-selected"].includes(e)}(t)?e.removeAttribute(t):(nt(t)&&(n=t),function(e,t,n){e.getAttribute(t)!=n&&e.setAttribute(t,n)}(e,t,n))}function et(e,t){return e==t}function tt(e){return!![1,"1","true","on","yes",!0].includes(e)||![0,"0","false","off","no",!1].includes(e)&&(e?Boolean(e):null)}function nt(e){return["disabled","checked","required","readonly","open","selected","autofocus","itemscope","multiple","novalidate","allowfullscreen","allowpaymentrequest","formnovalidate","autoplay","controls","loop","muted","playsinline","default","ismap","reversed","async","defer","nomodule"].includes(e)}function it(e,t,n){let i=e.getAttribute(t);return null===i?"function"==typeof n?n():n:""===i||(nt(t)?!![t,"true"].includes(i):i)}function st(e,t){var n;return function(){var i=this,s=arguments;clearTimeout(n),n=setTimeout((function(){n=null,e.apply(i,s)}),t)}}function rt(e,t){let n;return function(){let i=arguments;n||(e.apply(this,i),n=!0,setTimeout((()=>n=!1),t))}}function ot({get:e,set:t},{get:n,set:i}){let o,a,l=!0,c=s((()=>{let s=e(),r=n();if(l)i(at(s)),l=!1;else{let e=JSON.stringify(s),n=JSON.stringify(r);e!==o?i(at(s)):e!==n&&t(at(r))}o=JSON.stringify(e()),a=JSON.stringify(n())}));return()=>{r(c)}}function at(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e}var lt={},ct=!1,ut={};function dt(e,t,n){let i=[];for(;i.length;)i.pop()();let s=Object.entries(t).map((([e,t])=>({name:e,value:t}))),r=re(s);return s=s.map((e=>r.find((t=>t.name===e.name))?{name:`x-bind:${e.name}`,value:`"${e.value}"`}:e)),se(e,s,n).map((e=>{i.push(e.runCleanups),e()})),()=>{for(;i.length;)i.pop()()}}var ht={},pt={get reactive(){return i},get release(){return r},get effect(){return s},get raw(){return o},version:"3.14.1",flushAndStopDeferringMutations:function(){A=!1,L(j),j=[]},dontAutoEvaluateFunctions:G,disableEffectScheduling:function(e){p=!1,e(),p=!0},startObservingMutations:S,stopObservingMutations:P,setReactivityEngine:function(e){i=e.reactive,r=e.release,s=t=>e.effect(t,{scheduler:e=>{p?function(e){var t;t=e,c.includes(t)||c.push(t),l||a||(a=!0,queueMicrotask(h))}(e):e()}}),o=e.raw},onAttributeRemoved:w,onAttributesAdded:b,closestDataStack:I,skipDuringClone:Ge,onlyDuringClone:function(e){return(...t)=>He&&e(...t)},addRootSelector:Ce,addInitSelector:Ee,interceptClone:Je,addScopeToNode:$,deferMutations:function(){A=!0},mapAttributes:pe,evaluateLater:J,interceptInit:function(e){Le.push(e)},setEvaluator:function(e){Z=e},mergeProxies:T,extractProp:function(e,t,n,i=!0){if(e._x_bindings&&void 0!==e._x_bindings[t])return e._x_bindings[t];if(e._x_inlineBindings&&void 0!==e._x_inlineBindings[t]){let n=e._x_inlineBindings[t];return n.extract=i,G((()=>K(e,n.expression)))}return it(e,t,n)},findClosest:je,onElRemoved:y,closestRoot:Ae,destroyTree:$e,interceptor:R,transition:Ve,setStyles:Fe,mutateDom:E,directive:ie,entangle:ot,throttle:rt,debounce:st,evaluate:K,initTree:Oe,nextTick:Me,prefixed:te,prefix:function(e){ee=e},plugin:function(e){(Array.isArray(e)?e:[e]).forEach((e=>e(pt)))},magic:B,store:function(e,t){if(ct||(lt=i(lt),ct=!0),void 0===t)return lt[e];lt[e]=t,"object"==typeof t&&null!==t&&t.hasOwnProperty("init")&&"function"==typeof t.init&&lt[e].init(),D(lt[e])},start:function(){var e;xe&&we("Alpine has already been initialized on this page. Calling Alpine.start() more than once can cause problems."),xe=!0,document.body||we("Unable to initialize. Trying to load Alpine before `<body>` is available. Did you forget to add `defer` in Alpine's `<script>` tag?"),ye(document,"alpine:init"),ye(document,"alpine:initializing"),S(),e=e=>Oe(e,be),v.push(e),y((e=>$e(e))),b(((e,t)=>{se(e,t).forEach((e=>e()))})),Array.from(document.querySelectorAll(Pe().join(","))).filter((e=>!Ae(e.parentElement,!0))).forEach((e=>{Oe(e)})),ye(document,"alpine:initialized"),setTimeout((()=>{[["ui","dialog",["[x-dialog], [x-popover]"]],["anchor","anchor",["[x-anchor]"]],["sort","sort",["[x-sort]"]]].forEach((([e,t,n])=>{var i;i=t,Object.keys(ne).includes(i)||n.some((t=>{if(document.querySelector(t))return we(`found "${t}", but missing ${e} plugin`),!0}))}))}))},clone:function(e,t){t._x_dataStack||(t._x_dataStack=e._x_dataStack),He=!0,Ze=!0,Ye((()=>{!function(e){let t=!1;Oe(e,((e,n)=>{be(e,((e,i)=>{if(t&&function(e){return Se().some((t=>e.matches(t)))}(e))return i();t=!0,n(e,i)}))}))}(t)})),He=!1,Ze=!1},cloneNode:function(e,t){Ke.forEach((n=>n(e,t))),He=!0,Ye((()=>{Oe(t,((e,t)=>{t(e,(()=>{}))}))})),He=!1},bound:function(e,t,n){return e._x_bindings&&void 0!==e._x_bindings[t]?e._x_bindings[t]:it(e,t,n)},$data:O,watch:m,walk:be,data:function(e,t){ht[e]=t},bind:function(e,t){let n="function"!=typeof t?()=>t:t;return e instanceof Element?dt(e,n()):(ut[e]=n,()=>{})}};function ft(e,t){const n=Object.create(null),i=e.split(",");for(let e=0;e<i.length;e++)n[i[e]]=!0;return t?e=>!!n[e.toLowerCase()]:e=>!!n[e]}var mt,gt=Object.freeze({}),_t=(Object.freeze([]),Object.prototype.hasOwnProperty),vt=(e,t)=>_t.call(e,t),yt=Array.isArray,bt=e=>"[object Map]"===zt(e),wt=e=>"symbol"==typeof e,xt=e=>null!==e&&"object"==typeof e,kt=Object.prototype.toString,zt=e=>kt.call(e),St=e=>zt(e).slice(8,-1),Pt=e=>"string"==typeof e&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,Ct=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},Et=/-(\w)/g,At=(Ct((e=>e.replace(Et,((e,t)=>t?t.toUpperCase():"")))),/\B([A-Z])/g),jt=(Ct((e=>e.replace(At,"-$1").toLowerCase())),Ct((e=>e.charAt(0).toUpperCase()+e.slice(1)))),Lt=(Ct((e=>e?`on${jt(e)}`:"")),(e,t)=>e!==t&&(e==e||t==t)),Ot=new WeakMap,$t=[],It=Symbol("iterate"),Tt=Symbol("Map key iterate"),Mt=0;function Nt(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}var Dt=!0,Rt=[];function Ft(){const e=Rt.pop();Dt=void 0===e||e}function Ut(e,t,n){if(!Dt||void 0===mt)return;let i=Ot.get(e);i||Ot.set(e,i=new Map);let s=i.get(n);s||i.set(n,s=new Set),s.has(mt)||(s.add(mt),mt.deps.push(s),mt.options.onTrack&&mt.options.onTrack({effect:mt,target:e,type:t,key:n}))}function Bt(e,t,n,i,s,r){const o=Ot.get(e);if(!o)return;const a=new Set,l=e=>{e&&e.forEach((e=>{(e!==mt||e.allowRecurse)&&a.add(e)}))};if("clear"===t)o.forEach(l);else if("length"===n&&yt(e))o.forEach(((e,t)=>{("length"===t||t>=i)&&l(e)}));else switch(void 0!==n&&l(o.get(n)),t){case"add":yt(e)?Pt(n)&&l(o.get("length")):(l(o.get(It)),bt(e)&&l(o.get(Tt)));break;case"delete":yt(e)||(l(o.get(It)),bt(e)&&l(o.get(Tt)));break;case"set":bt(e)&&l(o.get(It))}a.forEach((o=>{o.options.onTrigger&&o.options.onTrigger({effect:o,target:e,key:n,type:t,newValue:i,oldValue:s,oldTarget:r}),o.options.scheduler?o.options.scheduler(o):o()}))}var Wt=ft("__proto__,__v_isRef,__isVue"),Vt=new Set(Object.getOwnPropertyNames(Symbol).map((e=>Symbol[e])).filter(wt)),qt=Jt(),Ht=Jt(!0),Gt=Kt();function Kt(){const e={};return["includes","indexOf","lastIndexOf"].forEach((t=>{e[t]=function(...e){const n=jn(this);for(let e=0,t=this.length;e<t;e++)Ut(n,"get",e+"");const i=n[t](...e);return-1===i||!1===i?n[t](...e.map(jn)):i}})),["push","pop","shift","unshift","splice"].forEach((t=>{e[t]=function(...e){Rt.push(Dt),Dt=!1;const n=jn(this)[t].apply(this,e);return Ft(),n}})),e}function Jt(e=!1,t=!1){return function(n,i,s){if("__v_isReactive"===i)return!e;if("__v_isReadonly"===i)return e;if("__v_raw"===i&&s===(e?t?Pn:Sn:t?zn:kn).get(n))return n;const r=yt(n);if(!e&&r&&vt(Gt,i))return Reflect.get(Gt,i,s);const o=Reflect.get(n,i,s);return(wt(i)?Vt.has(i):Wt(i))?o:(e||Ut(n,"get",i),t?o:Ln(o)?r&&Pt(i)?o:o.value:xt(o)?e?En(o):Cn(o):o)}}function Zt(e=!1){return function(t,n,i,s){let r=t[n];if(!e&&(i=jn(i),r=jn(r),!yt(t)&&Ln(r)&&!Ln(i)))return r.value=i,!0;const o=yt(t)&&Pt(n)?Number(n)<t.length:vt(t,n),a=Reflect.set(t,n,i,s);return t===jn(s)&&(o?Lt(i,r)&&Bt(t,"set",n,i,r):Bt(t,"add",n,i)),a}}var Yt={get:qt,set:Zt(),deleteProperty:function(e,t){const n=vt(e,t),i=e[t],s=Reflect.deleteProperty(e,t);return s&&n&&Bt(e,"delete",t,void 0,i),s},has:function(e,t){const n=Reflect.has(e,t);return wt(t)&&Vt.has(t)||Ut(e,"has",t),n},ownKeys:function(e){return Ut(e,"iterate",yt(e)?"length":It),Reflect.ownKeys(e)}},Xt={get:Ht,set:(e,t)=>(console.warn(`Set operation on key "${String(t)}" failed: target is readonly.`,e),!0),deleteProperty:(e,t)=>(console.warn(`Delete operation on key "${String(t)}" failed: target is readonly.`,e),!0)},Qt=e=>xt(e)?Cn(e):e,en=e=>xt(e)?En(e):e,tn=e=>e,nn=e=>Reflect.getPrototypeOf(e);function sn(e,t,n=!1,i=!1){const s=jn(e=e.__v_raw),r=jn(t);t!==r&&!n&&Ut(s,"get",t),!n&&Ut(s,"get",r);const{has:o}=nn(s),a=i?tn:n?en:Qt;return o.call(s,t)?a(e.get(t)):o.call(s,r)?a(e.get(r)):void(e!==s&&e.get(t))}function rn(e,t=!1){const n=this.__v_raw,i=jn(n),s=jn(e);return e!==s&&!t&&Ut(i,"has",e),!t&&Ut(i,"has",s),e===s?n.has(e):n.has(e)||n.has(s)}function on(e,t=!1){return e=e.__v_raw,!t&&Ut(jn(e),"iterate",It),Reflect.get(e,"size",e)}function an(e){e=jn(e);const t=jn(this);return nn(t).has.call(t,e)||(t.add(e),Bt(t,"add",e,e)),this}function ln(e,t){t=jn(t);const n=jn(this),{has:i,get:s}=nn(n);let r=i.call(n,e);r?xn(n,i,e):(e=jn(e),r=i.call(n,e));const o=s.call(n,e);return n.set(e,t),r?Lt(t,o)&&Bt(n,"set",e,t,o):Bt(n,"add",e,t),this}function cn(e){const t=jn(this),{has:n,get:i}=nn(t);let s=n.call(t,e);s?xn(t,n,e):(e=jn(e),s=n.call(t,e));const r=i?i.call(t,e):void 0,o=t.delete(e);return s&&Bt(t,"delete",e,void 0,r),o}function un(){const e=jn(this),t=0!==e.size,n=bt(e)?new Map(e):new Set(e),i=e.clear();return t&&Bt(e,"clear",void 0,void 0,n),i}function dn(e,t){return function(n,i){const s=this,r=s.__v_raw,o=jn(r),a=t?tn:e?en:Qt;return!e&&Ut(o,"iterate",It),r.forEach(((e,t)=>n.call(i,a(e),a(t),s)))}}function hn(e,t,n){return function(...i){const s=this.__v_raw,r=jn(s),o=bt(r),a="entries"===e||e===Symbol.iterator&&o,l="keys"===e&&o,c=s[e](...i),u=n?tn:t?en:Qt;return!t&&Ut(r,"iterate",l?Tt:It),{next(){const{value:e,done:t}=c.next();return t?{value:e,done:t}:{value:a?[u(e[0]),u(e[1])]:u(e),done:t}},[Symbol.iterator](){return this}}}}function pn(e){return function(...t){{const n=t[0]?`on key "${t[0]}" `:"";console.warn(`${jt(e)} operation ${n}failed: target is readonly.`,jn(this))}return"delete"!==e&&this}}function fn(){const e={get(e){return sn(this,e)},get size(){return on(this)},has:rn,add:an,set:ln,delete:cn,clear:un,forEach:dn(!1,!1)},t={get(e){return sn(this,e,!1,!0)},get size(){return on(this)},has:rn,add:an,set:ln,delete:cn,clear:un,forEach:dn(!1,!0)},n={get(e){return sn(this,e,!0)},get size(){return on(this,!0)},has(e){return rn.call(this,e,!0)},add:pn("add"),set:pn("set"),delete:pn("delete"),clear:pn("clear"),forEach:dn(!0,!1)},i={get(e){return sn(this,e,!0,!0)},get size(){return on(this,!0)},has(e){return rn.call(this,e,!0)},add:pn("add"),set:pn("set"),delete:pn("delete"),clear:pn("clear"),forEach:dn(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach((s=>{e[s]=hn(s,!1,!1),n[s]=hn(s,!0,!1),t[s]=hn(s,!1,!0),i[s]=hn(s,!0,!0)})),[e,n,t,i]}var[mn,gn,_n,vn]=fn();function yn(e,t){const n=t?e?vn:_n:e?gn:mn;return(t,i,s)=>"__v_isReactive"===i?!e:"__v_isReadonly"===i?e:"__v_raw"===i?t:Reflect.get(vt(n,i)&&i in t?n:t,i,s)}var bn={get:yn(!1,!1)},wn={get:yn(!0,!1)};function xn(e,t,n){const i=jn(n);if(i!==n&&t.call(e,i)){const t=St(e);console.warn(`Reactive ${t} contains both the raw and reactive versions of the same object${"Map"===t?" as keys":""}, which can lead to inconsistencies. Avoid differentiating between the raw and reactive versions of an object and only use the reactive version if possible.`)}}var kn=new WeakMap,zn=new WeakMap,Sn=new WeakMap,Pn=new WeakMap;function Cn(e){return e&&e.__v_isReadonly?e:An(e,!1,Yt,bn,kn)}function En(e){return An(e,!0,Xt,wn,Sn)}function An(e,t,n,i,s){if(!xt(e))return console.warn(`value cannot be made reactive: ${String(e)}`),e;if(e.__v_raw&&(!t||!e.__v_isReactive))return e;const r=s.get(e);if(r)return r;const o=(a=e).__v_skip||!Object.isExtensible(a)?0:function(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}(St(a));var a;if(0===o)return e;const l=new Proxy(e,2===o?i:n);return s.set(e,l),l}function jn(e){return e&&jn(e.__v_raw)||e}function Ln(e){return Boolean(e&&!0===e.__v_isRef)}B("nextTick",(()=>Me)),B("dispatch",(e=>ye.bind(ye,e))),B("watch",((e,{evaluateLater:t,cleanup:n})=>(e,i)=>{let s=t(e),r=m((()=>{let e;return s((t=>e=t)),e}),i);n(r)})),B("store",(function(){return lt})),B("data",(e=>O(e))),B("root",(e=>Ae(e))),B("refs",(e=>(e._x_refs_proxy||(e._x_refs_proxy=T(function(e){let t=[];return je(e,(e=>{e._x_refs&&t.push(e._x_refs)})),t}(e))),e._x_refs_proxy)));var On={};function $n(e){return On[e]||(On[e]=0),++On[e]}function In(e,t,n){B(t,(i=>we(`You can't use [$${t}] without first installing the "${e}" plugin here: https://alpinejs.dev/plugins/${n}`,i)))}B("id",((e,{cleanup:t})=>(n,i=null)=>function(e,t,n,i){if(e._x_id||(e._x_id={}),e._x_id[t])return e._x_id[t];let s=i();return e._x_id[t]=s,n((()=>{delete e._x_id[t]})),s}(e,`${n}${i?`-${i}`:""}`,t,(()=>{let t=function(e,t){return je(e,(e=>{if(e._x_ids&&e._x_ids[t])return!0}))}(e,n),s=t?t._x_ids[n]:$n(n);return i?`${n}-${s}-${i}`:`${n}-${s}`})))),Je(((e,t)=>{e._x_id&&(t._x_id=e._x_id)})),B("el",(e=>e)),In("Focus","focus","focus"),In("Persist","persist","persist"),ie("modelable",((e,{expression:t},{effect:n,evaluateLater:i,cleanup:s})=>{let r=i(t),o=()=>{let e;return r((t=>e=t)),e},a=i(`${t} = __placeholder`),l=e=>a((()=>{}),{scope:{__placeholder:e}}),c=o();l(c),queueMicrotask((()=>{if(!e._x_model)return;e._x_removeModelListeners.default();let t=e._x_model.get,n=e._x_model.set,i=ot({get:()=>t(),set(e){n(e)}},{get:()=>o(),set(e){l(e)}});s(i)}))})),ie("teleport",((e,{modifiers:t,expression:n},{cleanup:i})=>{"template"!==e.tagName.toLowerCase()&&we("x-teleport can only be used on a <template> tag",e);let s=Mn(n),r=e.content.cloneNode(!0).firstElementChild;e._x_teleport=r,r._x_teleportBack=e,e.setAttribute("data-teleport-template",!0),r.setAttribute("data-teleport-target",!0),e._x_forwardEvents&&e._x_forwardEvents.forEach((t=>{r.addEventListener(t,(t=>{t.stopPropagation(),e.dispatchEvent(new t.constructor(t.type,t))}))})),$(r,{},e);let o=(e,t,n)=>{n.includes("prepend")?t.parentNode.insertBefore(e,t):n.includes("append")?t.parentNode.insertBefore(e,t.nextSibling):t.appendChild(e)};E((()=>{o(r,s,t),Ge((()=>{Oe(r),r._x_ignore=!0}))()})),e._x_teleportPutBack=()=>{let i=Mn(n);E((()=>{o(e._x_teleport,i,t)}))},i((()=>r.remove()))}));var Tn=document.createElement("div");function Mn(e){let t=Ge((()=>document.querySelector(e)),(()=>Tn))();return t||we(`Cannot find x-teleport element for selector: "${e}"`),t}var Nn=()=>{};function Dn(e,t,n,i){let s=e,r=e=>i(e),o={},a=(e,t)=>n=>t(e,n);if(n.includes("dot")&&(t=t.replace(/-/g,".")),n.includes("camel")&&(t=t.toLowerCase().replace(/-(\w)/g,((e,t)=>t.toUpperCase()))),n.includes("passive")&&(o.passive=!0),n.includes("capture")&&(o.capture=!0),n.includes("window")&&(s=window),n.includes("document")&&(s=document),n.includes("debounce")){let e=n[n.indexOf("debounce")+1]||"invalid-wait",t=Rn(e.split("ms")[0])?Number(e.split("ms")[0]):250;r=st(r,t)}if(n.includes("throttle")){let e=n[n.indexOf("throttle")+1]||"invalid-wait",t=Rn(e.split("ms")[0])?Number(e.split("ms")[0]):250;r=rt(r,t)}return n.includes("prevent")&&(r=a(r,((e,t)=>{t.preventDefault(),e(t)}))),n.includes("stop")&&(r=a(r,((e,t)=>{t.stopPropagation(),e(t)}))),n.includes("once")&&(r=a(r,((e,n)=>{e(n),s.removeEventListener(t,r,o)}))),(n.includes("away")||n.includes("outside"))&&(s=document,r=a(r,((t,n)=>{e.contains(n.target)||!1!==n.target.isConnected&&(e.offsetWidth<1&&e.offsetHeight<1||!1!==e._x_isShown&&t(n))}))),n.includes("self")&&(r=a(r,((t,n)=>{n.target===e&&t(n)}))),(function(e){return["keydown","keyup"].includes(e)}(t)||Fn(t))&&(r=a(r,((e,t)=>{(function(e,t){let n=t.filter((e=>!["window","document","prevent","stop","once","capture","self","away","outside","passive"].includes(e)));if(n.includes("debounce")){let e=n.indexOf("debounce");n.splice(e,Rn((n[e+1]||"invalid-wait").split("ms")[0])?2:1)}if(n.includes("throttle")){let e=n.indexOf("throttle");n.splice(e,Rn((n[e+1]||"invalid-wait").split("ms")[0])?2:1)}if(0===n.length)return!1;if(1===n.length&&Un(e.key).includes(n[0]))return!1;const i=["ctrl","shift","alt","meta","cmd","super"].filter((e=>n.includes(e)));if(n=n.filter((e=>!i.includes(e))),i.length>0&&i.filter((t=>("cmd"!==t&&"super"!==t||(t="meta"),e[`${t}Key`]))).length===i.length){if(Fn(e.type))return!1;if(Un(e.key).includes(n[0]))return!1}return!0})(t,n)||e(t)}))),s.addEventListener(t,r,o),()=>{s.removeEventListener(t,r,o)}}function Rn(e){return!Array.isArray(e)&&!isNaN(e)}function Fn(e){return["contextmenu","click","mouse"].some((t=>e.includes(t)))}function Un(e){if(!e)return[];var t;e=[" ","_"].includes(t=e)?t:t.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[_\s]/,"-").toLowerCase();let n={ctrl:"control",slash:"/",space:" ",spacebar:" ",cmd:"meta",esc:"escape",up:"arrow-up",down:"arrow-down",left:"arrow-left",right:"arrow-right",period:".",comma:",",equal:"=",minus:"-",underscore:"_"};return n[e]=e,Object.keys(n).map((t=>{if(n[t]===e)return t})).filter((e=>e))}function Bn(e,t,n,i){return E((()=>{if(n instanceof CustomEvent&&void 0!==n.detail)return null!==n.detail&&void 0!==n.detail?n.detail:n.target.value;if("checkbox"===e.type){if(Array.isArray(i)){let e=null;return e=t.includes("number")?Wn(n.target.value):t.includes("boolean")?tt(n.target.value):n.target.value,n.target.checked?i.includes(e)?i:i.concat([e]):i.filter((t=>!(t==e)))}return n.target.checked}if("select"===e.tagName.toLowerCase()&&e.multiple)return t.includes("number")?Array.from(n.target.selectedOptions).map((e=>Wn(e.value||e.text))):t.includes("boolean")?Array.from(n.target.selectedOptions).map((e=>tt(e.value||e.text))):Array.from(n.target.selectedOptions).map((e=>e.value||e.text));{let s;return s="radio"===e.type?n.target.checked?n.target.value:i:n.target.value,t.includes("number")?Wn(s):t.includes("boolean")?tt(s):t.includes("trim")?s.trim():s}}))}function Wn(e){let t=e?parseFloat(e):null;return n=t,Array.isArray(n)||isNaN(n)?e:t;var n}function Vn(e){return null!==e&&"object"==typeof e&&"function"==typeof e.get&&"function"==typeof e.set}Nn.inline=(e,{modifiers:t},{cleanup:n})=>{t.includes("self")?e._x_ignoreSelf=!0:e._x_ignore=!0,n((()=>{t.includes("self")?delete e._x_ignoreSelf:delete e._x_ignore}))},ie("ignore",Nn),ie("effect",Ge(((e,{expression:t},{effect:n})=>{n(J(e,t))}))),ie("model",((e,{modifiers:t,expression:n},{effect:i,cleanup:s})=>{let r=e;t.includes("parent")&&(r=e.parentNode);let o,a=J(r,n);o="string"==typeof n?J(r,`${n} = __placeholder`):"function"==typeof n&&"string"==typeof n()?J(r,`${n()} = __placeholder`):()=>{};let l=()=>{let e;return a((t=>e=t)),Vn(e)?e.get():e},c=e=>{let t;a((e=>t=e)),Vn(t)?t.set(e):o((()=>{}),{scope:{__placeholder:e}})};"string"==typeof n&&"radio"===e.type&&E((()=>{e.hasAttribute("name")||e.setAttribute("name",n)}));var u="select"===e.tagName.toLowerCase()||["checkbox","radio"].includes(e.type)||t.includes("lazy")?"change":"input";let d=He?()=>{}:Dn(e,u,t,(n=>{c(Bn(e,t,n,l()))}));if(t.includes("fill")&&([void 0,null,""].includes(l())||"checkbox"===e.type&&Array.isArray(l())||"select"===e.tagName.toLowerCase()&&e.multiple)&&c(Bn(e,t,{target:e},l())),e._x_removeModelListeners||(e._x_removeModelListeners={}),e._x_removeModelListeners.default=d,s((()=>e._x_removeModelListeners.default())),e.form){let n=Dn(e.form,"reset",[],(n=>{Me((()=>e._x_model&&e._x_model.set(Bn(e,t,{target:e},l()))))}));s((()=>n()))}e._x_model={get:()=>l(),set(e){c(e)}},e._x_forceModelUpdate=t=>{void 0===t&&"string"==typeof n&&n.match(/\./)&&(t=""),window.fromModel=!0,E((()=>Xe(e,"value",t))),delete window.fromModel},i((()=>{let n=l();t.includes("unintrusive")&&document.activeElement.isSameNode(e)||e._x_forceModelUpdate(n)}))})),ie("cloak",(e=>queueMicrotask((()=>E((()=>e.removeAttribute(te("cloak")))))))),Ee((()=>`[${te("init")}]`)),ie("init",Ge(((e,{expression:t},{evaluate:n})=>"string"==typeof t?!!t.trim()&&n(t,{},!1):n(t,{},!1)))),ie("text",((e,{expression:t},{effect:n,evaluateLater:i})=>{let s=i(t);n((()=>{s((t=>{E((()=>{e.textContent=t}))}))}))})),ie("html",((e,{expression:t},{effect:n,evaluateLater:i})=>{let s=i(t);n((()=>{s((t=>{E((()=>{e.innerHTML=t,e._x_ignoreSelf=!0,Oe(e),delete e._x_ignoreSelf}))}))}))})),pe(ue(":",te("bind:")));var qn=(e,{value:t,modifiers:n,expression:i,original:s},{effect:r,cleanup:o})=>{if(!t){let t={};return a=t,Object.entries(ut).forEach((([e,t])=>{Object.defineProperty(a,e,{get:()=>(...e)=>t(...e)})})),void J(e,i)((t=>{dt(e,t,s)}),{scope:t})}var a;if("key"===t)return function(e,t){e._x_keyExpression=t}(e,i);if(e._x_inlineBindings&&e._x_inlineBindings[t]&&e._x_inlineBindings[t].extract)return;let l=J(e,i);r((()=>l((s=>{void 0===s&&"string"==typeof i&&i.match(/\./)&&(s=""),E((()=>Xe(e,t,s,n)))})))),o((()=>{e._x_undoAddedClasses&&e._x_undoAddedClasses(),e._x_undoAddedStyles&&e._x_undoAddedStyles()}))};function Hn(e,t,n,i){let s={};return/^\[.*\]$/.test(e.item)&&Array.isArray(t)?e.item.replace("[","").replace("]","").split(",").map((e=>e.trim())).forEach(((e,n)=>{s[e]=t[n]})):/^\{.*\}$/.test(e.item)&&!Array.isArray(t)&&"object"==typeof t?e.item.replace("{","").replace("}","").split(",").map((e=>e.trim())).forEach((e=>{s[e]=t[e]})):s[e.item]=t,e.index&&(s[e.index]=n),e.collection&&(s[e.collection]=i),s}function Gn(){}function Kn(e,t,n){ie(t,(i=>we(`You can't use [x-${t}] without first installing the "${e}" plugin here: https://alpinejs.dev/plugins/${n}`,i)))}qn.inline=(e,{value:t,modifiers:n,expression:i})=>{t&&(e._x_inlineBindings||(e._x_inlineBindings={}),e._x_inlineBindings[t]={expression:i,extract:!1})},ie("bind",qn),Ce((()=>`[${te("data")}]`)),ie("data",((e,{expression:t},{cleanup:n})=>{if(function(e){return!!He&&(!!Ze||e.hasAttribute("data-has-alpine-state"))}(e))return;t=""===t?"{}":t;let s={};W(s,e);let r={};var o,a;o=r,a=s,Object.entries(ht).forEach((([e,t])=>{Object.defineProperty(o,e,{get:()=>(...e)=>t.bind(a)(...e),enumerable:!1})}));let l=K(e,t,{scope:r});void 0!==l&&!0!==l||(l={}),W(l,e);let c=i(l);D(c);let u=$(e,c);c.init&&K(e,c.init),n((()=>{c.destroy&&K(e,c.destroy),u()}))})),Je(((e,t)=>{e._x_dataStack&&(t._x_dataStack=e._x_dataStack,t.setAttribute("data-has-alpine-state",!0))})),ie("show",((e,{modifiers:t,expression:n},{effect:i})=>{let s=J(e,n);e._x_doHide||(e._x_doHide=()=>{E((()=>{e.style.setProperty("display","none",t.includes("important")?"important":void 0)}))}),e._x_doShow||(e._x_doShow=()=>{E((()=>{1===e.style.length&&"none"===e.style.display?e.removeAttribute("style"):e.style.removeProperty("display")}))});let r,o=()=>{e._x_doHide(),e._x_isShown=!1},a=()=>{e._x_doShow(),e._x_isShown=!0},l=()=>setTimeout(a),c=Ue((e=>e?a():o()),(t=>{"function"==typeof e._x_toggleAndCascadeWithTransitions?e._x_toggleAndCascadeWithTransitions(e,t,a,o):t?l():o()})),u=!0;i((()=>s((e=>{(u||e!==r)&&(t.includes("immediate")&&(e?l():o()),c(e),r=e,u=!1)}))))})),ie("for",((e,{expression:t},{effect:n,cleanup:s})=>{let r=function(e){let t=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,n=e.match(/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/);if(!n)return;let i={};i.items=n[2].trim();let s=n[1].replace(/^\s*\(|\)\s*$/g,"").trim(),r=s.match(t);return r?(i.item=s.replace(t,"").trim(),i.index=r[1].trim(),r[2]&&(i.collection=r[2].trim())):i.item=s,i}(t),o=J(e,r.items),a=J(e,e._x_keyExpression||"index");e._x_prevKeys=[],e._x_lookup={},n((()=>function(e,t,n,s){let r=e;n((n=>{var o;o=n,!Array.isArray(o)&&!isNaN(o)&&n>=0&&(n=Array.from(Array(n).keys(),(e=>e+1))),void 0===n&&(n=[]);let a=e._x_lookup,l=e._x_prevKeys,c=[],u=[];if("object"!=typeof(h=n)||Array.isArray(h))for(let i=0;i<n.length;i++){let r=Hn(t,n[i],i,n);s((t=>{u.includes(t)&&we("Duplicate key on x-for",e),u.push(t)}),{scope:{index:i,...r}}),c.push(r)}else n=Object.entries(n).map((([i,r])=>{let o=Hn(t,r,i,n);s((t=>{u.includes(t)&&we("Duplicate key on x-for",e),u.push(t)}),{scope:{index:i,...o}}),c.push(o)}));var h;let p=[],f=[],m=[],g=[];for(let e=0;e<l.length;e++){let t=l[e];-1===u.indexOf(t)&&m.push(t)}l=l.filter((e=>!m.includes(e)));let _="template";for(let e=0;e<u.length;e++){let t=u[e],n=l.indexOf(t);if(-1===n)l.splice(e,0,t),p.push([_,e]);else if(n!==e){let t=l.splice(e,1)[0],i=l.splice(n-1,1)[0];l.splice(e,0,i),l.splice(n,0,t),f.push([t,i])}else g.push(t);_=t}for(let e=0;e<m.length;e++){let t=m[e];a[t]._x_effects&&a[t]._x_effects.forEach(d),a[t].remove(),a[t]=null,delete a[t]}for(let e=0;e<f.length;e++){let[t,n]=f[e],i=a[t],s=a[n],o=document.createElement("div");E((()=>{s||we('x-for ":key" is undefined or invalid',r,n,a),s.after(o),i.after(s),s._x_currentIfEl&&s.after(s._x_currentIfEl),o.before(i),i._x_currentIfEl&&i.after(i._x_currentIfEl),o.remove()})),s._x_refreshXForScope(c[u.indexOf(n)])}for(let e=0;e<p.length;e++){let[t,n]=p[e],s="template"===t?r:a[t];s._x_currentIfEl&&(s=s._x_currentIfEl);let o=c[n],l=u[n],d=document.importNode(r.content,!0).firstElementChild,h=i(o);$(d,h,r),d._x_refreshXForScope=e=>{Object.entries(e).forEach((([e,t])=>{h[e]=t}))},E((()=>{s.after(d),Ge((()=>Oe(d)))()})),"object"==typeof l&&we("x-for key cannot be an object, it must be a string or an integer",r),a[l]=d}for(let e=0;e<g.length;e++)a[g[e]]._x_refreshXForScope(c[u.indexOf(g[e])]);r._x_prevKeys=u}))}(e,r,o,a))),s((()=>{Object.values(e._x_lookup).forEach((e=>e.remove())),delete e._x_prevKeys,delete e._x_lookup}))})),Gn.inline=(e,{expression:t},{cleanup:n})=>{let i=Ae(e);i._x_refs||(i._x_refs={}),i._x_refs[t]=e,n((()=>delete i._x_refs[t]))},ie("ref",Gn),ie("if",((e,{expression:t},{effect:n,cleanup:i})=>{"template"!==e.tagName.toLowerCase()&&we("x-if can only be used on a <template> tag",e);let s=J(e,t);n((()=>s((t=>{t?(()=>{if(e._x_currentIfEl)return e._x_currentIfEl;let t=e.content.cloneNode(!0).firstElementChild;$(t,{},e),E((()=>{e.after(t),Ge((()=>Oe(t)))()})),e._x_currentIfEl=t,e._x_undoIf=()=>{be(t,(e=>{e._x_effects&&e._x_effects.forEach(d)})),t.remove(),delete e._x_currentIfEl}})():e._x_undoIf&&(e._x_undoIf(),delete e._x_undoIf)})))),i((()=>e._x_undoIf&&e._x_undoIf()))})),ie("id",((e,{expression:t},{evaluate:n})=>{n(t).forEach((t=>function(e,t){e._x_ids||(e._x_ids={}),e._x_ids[t]||(e._x_ids[t]=$n(t))}(e,t)))})),Je(((e,t)=>{e._x_ids&&(t._x_ids=e._x_ids)})),pe(ue("@",te("on:"))),ie("on",Ge(((e,{value:t,modifiers:n,expression:i},{cleanup:s})=>{let r=i?J(e,i):()=>{};"template"===e.tagName.toLowerCase()&&(e._x_forwardEvents||(e._x_forwardEvents=[]),e._x_forwardEvents.includes(t)||e._x_forwardEvents.push(t));let o=Dn(e,t,n,(e=>{r((()=>{}),{scope:{$event:e},params:[e]})}));s((()=>o()))}))),Kn("Collapse","collapse","collapse"),Kn("Intersect","intersect","intersect"),Kn("Focus","trap","focus"),Kn("Mask","mask","mask"),pt.setEvaluator(Y),pt.setReactivityEngine({reactive:Cn,effect:function(e,t=gt){(function(e){return e&&!0===e._isEffect})(e)&&(e=e.raw);const n=function(e,t){const n=function(){if(!n.active)return e();if(!$t.includes(n)){Nt(n);try{return Rt.push(Dt),Dt=!0,$t.push(n),mt=n,e()}finally{$t.pop(),Ft(),mt=$t[$t.length-1]}}};return n.id=Mt++,n.allowRecurse=!!t.allowRecurse,n._isEffect=!0,n.active=!0,n.raw=e,n.deps=[],n.options=t,n}(e,t);return t.lazy||n(),n},release:function(e){e.active&&(Nt(e),e.options.onStop&&e.options.onStop(),e.active=!1)},raw:jn});var Jn=pt},326:(e,t,n)=>{"use strict";n.r(t),n.d(t,{genreInfo:()=>s,genres:()=>i});const i=["blackbox","bridges","cube","dominosa","fifteen","filling","flip","flood","galaxies","guess","inertia","keen","lightup","loopy","magnets","map","mines","mosaic","net","netslide","palisade","pattern","pearl","pegs","range","rect","samegame","signpost","singles","sixteen","slant","solo","tents","towers","tracks","twiddle","undead","unequal","unruly","untangle","group","abcd","ascent","boats","bricks","clusters","crossing","mathrax","rome","salad","seismic","spokes","sticks","subsets"],s={blackbox:{name:"Blackbox",description:"Use beam reflections to locate the hidden marbles.",rules:["Click a wall on the border to fire a beam from it.","Numbers indicate that a beam leaving from one wall will hit the wall with the same number.","An H indicates that the beam will hit a marble.","An R indicates that the beam will be reflected to the same wall.","When a beam enters a tile diagonally adjacent to a marble, it will be deflected 90 degrees away from it.","When a beam enters a tile diagonally adjacent to two marbles, it will be reflected back the way it came.","If a marble is diagonally adjacent to a wall, it will reflect beams from that wall back to the same wall.","Beams are not reflected if a marble is directly in front of them."],controls:{primary:"Toggle marble; Fire laser",secondary:"Freeze cell",arrows:"Select cell"}},bridges:{name:"Bridges",description:"Connect the islands with the indicated number of bridges.",rules:["The total number of bridges extending from an island must equal the island's number.","There are at most 2 bridges between any two islands.","All islands are connected by bridges. (There may be loops.)"]},cube:{name:"Cube",description:"Roll the polyhedron so that all sides are painted blue."},dominosa:{name:"Dominosa",description:"Place dominoes so that each combination of numbers appears once."},fifteen:{name:"Fifteen",description:"Slide the tiles to arrange them in ascending order."},filling:{name:"Filling",description:"Fill the grid with numbers so that each number is connected to that many of itself."},flip:{name:"Flip",description:"Flip all the tiles to white."},flood:{name:"Flood",description:"Make the board a single color using flood-fills."},galaxies:{name:"Galaxies",description:"Divide the grid into rotationally symmetric regions."},group:{name:"Group",description:"Fill in the <a href='https://en.wikipedia.org/wiki/Cayley_table'>Cayley table</a> for a finite group.",hidden:!0,helpLink:"",rules:["In this summary, the letter at row x and column y is notated (xy).","Every letter appears exactly once in each row and column.","For any letters x, y, and z, ((xy)z) and (x(yz)) are the same. (Associativity law)","There is some letter e where, for all x, (ex) and (xe) are both x. (Identity law)","For each letter x, there is some letter y for which (xy) and (yx) are both e, as defined in the identity law. (Inverses law)","(Note: This puzzle is unfinished. See <a href='https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/group.html'>https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/group.html</a> for details.)"]},guess:{name:"Guess",description:"Guess the hidden color pattern.",rules:["Black circles indicate how many pegs are correct.","white circles indicate how many pegs are the right color, but in the wrong location."]},inertia:{name:"Inertia",description:"Collect all the gems while avoiding the mines."},keen:{name:"Keen",description:"Fill in numbers to satisfy mathematical operations.",rules:["Each row and column contains the numbers from 1 to the grid size exactly once.","Each region's numbers, when combined with the indicated operation, must form the indicated value.","If the operation is not specified, the numbers are combined using multiplication.","Regions can contain the same number multiple times."]},lightup:{name:"Lightup",description:"Light up the whole grid without shining lights on each other."},loopy:{name:"Loopy",description:"Draw a loop that touches each clue the right number of times."},magnets:{name:"Magnets",description:"Place magnets without letting similar polarities touch."},map:{name:"Map",description:"Color the map using only four colors."},mines:{name:"Mines",description:"Open every cell without clicking mines."},mosaic:{name:"Mosaic",description:"Shade some cells so that each clue is near the right number of shaded cells."},net:{name:"Net",description:"Rotate pieces to form a connected network."},netslide:{name:"NetSlide",description:"Slide rows and columns to form a connected network."},palisade:{name:"Palisade",description:"Divide the grid into regions of a given area."},pattern:{name:"Pattern",description:"Shade some cells so that each row and column has blocks of the indicated lengths."},pearl:{name:"Pearl",description:"Draw a loop that follows the rules of all the pearls.",rules:["The loop must turn at each black pearl, and go straight in both the cells immediately before and after it.","The loop must go straight at each white pearl, and turn in either the cell immediately before or after it (or both).","The loop must touch every pearl."]},pegs:{name:"Pegs",description:"Capture pegs by hopping them over each other until only one remains."},range:{name:"Range",description:"Shade cells so that each clue sees the indicated number of ushaded cells.",rules:["Clues indicate the total number of unshaded cells reachable in a horizontal or vertical line from the clue, including itself.","Shaded cells cannot be adjacent.","The unshaded cells must all be connected."]},rect:{name:"Rect",description:"Divide the grid into rectangles with the indicated areas."},samegame:{name:"SameGame",description:"Clear the grid by removing connected groups of colored blocks."},signpost:{name:"Signpost",description:"Number the cells so that each cell points to the next."},singles:{name:"Singles",description:"Shade some numbers so that there are no duplicates in a row or column.",rules:["Unshaded cells in the same row or column cannot have the same number.","Shaded cells cannot be adjacent.","The unshaded cells must all be connected."]},sixteen:{name:"Sixteen",description:"Slide rows and columns to arrange the numbers in ascending order."},slant:{name:"Slant",description:"Draw a slant in each cell so each clues touches the given number of lines."},solo:{name:"Solo",description:"Fill in numbers so there are no duplicates in a row, column, or block.",rules:["Each row, column, and block contains the numbers from 1 to the grid size exactly once.","If the diagonals are shaded, numbers must not repeat along a diagonal. (X Sudoku)","Cages with thin outlines, if present, must sum to the indicated value. Numbers cannot repeat within a cage. (Killer Sudoku)"]},tents:{name:"Tents",description:"Place a tent next to each tree so that none of them touch.",rules:["Each tree must be next to its own tent, and each tent must be next to its own tree.","A tent can be next to multiple trees, but it must be possible to pair the tents and trees without overlaps.","Tents cannot be adjacent, not even diagonally.","Clues indicate the number of tents in a row or column"]},towers:{name:"Towers",description:"Place towers so that the right amount can be seen from outside."},tracks:{name:"Tracks",description:"Draw train tracks from A to B that occupy the right numbers of cells in each row and column."},twiddle:{name:"Twiddle",description:"Rotate blocks of numbers to arrange them in ascending order."},undead:{name:"Undead",description:"Place monsters so that the right number can be seen through the mirrors.",rules:["Clues around the edge indicate how many monsters can be seen in a straight line from there.","Pre-placed diagonal lines are mirrors.","Vampires can't be seen through mirrors.","Ghosts can only be seen through mirrors.","Zombies are always visible.","Monsters may be counted multiple times if a sightline crosses its own path."]},unequal:{name:"Unequal",description:"Fill in numbers so that the inequality signs are satisfied.",rules:["Each row and column contains the numbers from 1 to the grid size exactly once.","Cells separated by a greater than or less than sign must satisfy that inequality.","If there are grey bars, numbers separated by grey bars must have a difference of 1.","If there are grey bars, numbers not separated by grey bars must have a difference of more than 1."]},unruly:{name:"Unruly",description:"Shade cells so that no line of three cells has the same color."},untangle:{name:"Untangle",description:"Untangle the graph so that no edges cross."},none:{name:"No puzzle loaded",description:"Click a puzzle to start it.",helpLink:""}};for(let e of["abcd","ascent","boats","bricks","clusters","crossing","mathrax","rome","salad","seismic","spokes","sticks","subsets"])s[e]={name:e,description:"Unsupported puzzle; subject to change.",helpLink:"https://github.com/x-sheep/puzzles-unreleased",hidden:!0,evenMoreHidden:!0}},291:(e,t,n)=>{"use strict";function i(e){return new Promise((function(t,n){e.onsuccess=n=>t(e.result),e.onerror=t=>n(e.error)}))}let s;n.r(t),n.d(t,{GameSave:()=>r,getFile:()=>l,getFileList:()=>a,openDatabase:()=>o});class r{constructor(e){e??={},this.id=e.id??null,this.filename=e.filename??null,this.host=e.host??"",this.port=e.port??0,this.player=e.player??"",this.password=e.password??"",this.baseSeed=""+(e.baseSeed??""),this.description="",this.finished=e.finished??!1,this.solveTarget=e.solveTarget??null,this.puzzles=e.puzzles??[],this.puzzleSolved=e.puzzleSolved??Array(this.puzzles.length).fill(!1),this.puzzleLocked=e.puzzleLocked??Array(this.puzzles.length).fill(!0),this.updateDescription()}async save(){if(-1==this.id)return;const e=s.transaction("gamesave","readwrite"),t=e.objectStore("gamesave");let n=this.toObject();null===n.id&&delete n.id;let r=await i(t.put(n));null===this.id&&(this.id=r),e.commit()}async getPuzzleSave(e){if(-1==this.id)return;const t=s.transaction("puzzlesave").objectStore("puzzlesave");let n=await i(t.get([this.id,e]));return n?n.data:null}async setPuzzleSave(e,t){if(-1==this.id)return;const n=s.transaction("puzzlesave","readwrite").objectStore("puzzlesave");let r={gameId:this.id,puzzleId:e,data:t};await i(n.put(r))}async deletePuzzleSave(e){if(-1==this.id)return;const t=s.transaction("puzzlesave","readwrite").objectStore("puzzlesave");await i(t.delete([this.id,e]))}async deleteFile(){if(-1==this.id)return;const e=s.transaction(["gamesave","puzzlesave"],"readwrite"),t=e.objectStore("gamesave");let n=[],r=async function*(e){let t;do{t=await i(e),t&&(yield t,t.continue())}while(t)}(e.objectStore("puzzlesave").index("gameId").openCursor(this.id));for await(let e of r)n.push(e.delete());n.push(i(t.delete(this.id))),e.commit(),await Promise.allSettled(n)}updateDescription(){this.description=this.toString()}toString(){return this.filename??`${this.player} (${this.host}:${this.port}${this.password?"*":""}), ${this.puzzles.length} puzzles`}toObject(){return{id:this.id,fliename:this.filename,host:this.host,port:this.port,player:this.player,password:this.password,baseSeed:this.baseSeed,finished:this.finished,puzzles:this.puzzles.slice(),puzzleSolved:this.puzzleSolved.slice(),puzzleLocked:this.puzzleLocked.slice(),solveTarget:this.solveTarget}}static fromObject(e){return new r(e)}}async function o(){let e=indexedDB.open("ap-puzzles",1);e.onupgradeneeded=function(t){let n=e.result;console.log("Creating indexedDB stores"),t.oldVersion<1&&(n.createObjectStore("gamesave",{keyPath:"id",autoIncrement:!0}),n.createObjectStore("puzzlesave",{keyPath:["gameId","puzzleId"]}).createIndex("gameId","gameId"))},s=await i(e)}async function a(){let e=s.transaction("gamesave").objectStore("gamesave"),t=await i(e.getAll());return t=t.map((e=>r.fromObject(e))),t}async function l(e){return new r.fromObject}},131:(e,t,n)=>{"use strict";n.r(t),n.d(t,{API:()=>s,ArgumentError:()=>d,BaseMessageNode:()=>A,Client:()=>F,ColorMessageNode:()=>O,DataPackageManager:()=>w,DataStorageManager:()=>k,DeathLinkManager:()=>P,EventBasedManager:()=>S,Hint:()=>C,IntermediateDataOperation:()=>x,Item:()=>y,ItemMessageNode:()=>j,ItemsManager:()=>E,LocationMessageNode:()=>L,LoginError:()=>h,MessageManager:()=>T,PackageMetadata:()=>b,Player:()=>M,PlayerMessageNode:()=>I,PlayersManager:()=>N,RoomStateManager:()=>D,SocketError:()=>u,SocketManager:()=>R,TextualMessageNode:()=>$,UnauthenticatedError:()=>p,clientStatuses:()=>r,defaultClientOptions:()=>f,defaultConnectionOptions:()=>v,itemClassifications:()=>o,itemsHandlingFlags:()=>a,libraryVersion:()=>g,permissions:()=>l,slotTypes:()=>c,targetVersion:()=>m});var i=Object.defineProperty,s={};((e,t)=>{for(var n in t)i(e,n,{get:t[n],enumerable:!0,configurable:!0,set:e=>t[n]=()=>e})})(s,{slotTypes:()=>c,permissions:()=>l,itemsHandlingFlags:()=>a,itemClassifications:()=>o,clientStatuses:()=>r});var r={disconnected:0,connected:5,ready:10,playing:20,goal:30},o={progression:1,useful:2,trap:4,none:0},a={minimal:0,others:1,own:2,starting:4,all:7},l={disabled:0,enabled:1,goal:2,auto:6,autoEnabled:7},c={spectator:0,player:1,group:2};class u extends Error{}class d extends Error{argumentName;value;constructor(e,t,n){super(e),this.argumentName=t,this.value=structuredClone(n)}}class h extends Error{errors=[];constructor(e,t){super(e),this.errors=t}}class p extends Error{}var f={timeout:1e4,autoFetchDataPackage:!0,maximumMessages:1e3,debugLogVersions:!0},m={major:0,minor:5,build:1},g="2.0.4";function _(){const e=[];for(let t=0;t<36;t++)e.push(Math.floor(16*Math.random()));return e[14]=4,e[19]=e[19]&=-5,e[19]=e[19]|=8,e[8]=e[13]=e[18]=e[23]="-",e.map((e=>e.toString(16))).join("")}var v={password:"",uuid:_(),tags:[],version:m,items:a.all,slotData:!0};class y{#e;#t;#n;#i;constructor(e,t,n,i){this.#e=e,this.#t=t,this.#n=n,this.#i=i}toString(){return this.name}get receiver(){return this.#i}get sender(){return this.#n}get name(){return this.#e.package.lookupItemName(this.game,this.#t.item,!0)}get id(){return this.#t.item}get locationName(){return this.#e.package.lookupLocationName(this.sender.game,this.#t.location,!0)}get locationId(){return this.#t.location}get locationGame(){return this.sender.game}get game(){return this.receiver.game}get progression(){return(this.flags&o.progression)===o.progression}get useful(){return(this.flags&o.useful)===o.useful}get trap(){return(this.flags&o.trap)===o.trap}get filler(){return this.flags===o.none}get flags(){return this.#t.flags}}class b{game;checksum;itemTable;locationTable;reverseItemTable;reverseLocationTable;constructor(e,t){this.game=e,this.checksum=t.checksum,this.itemTable=Object.freeze(t.item_name_to_id),this.locationTable=Object.freeze(t.location_name_to_id),this.reverseItemTable=Object.freeze(Object.fromEntries(Object.entries(this.itemTable).map((([e,t])=>[t,e])))),this.reverseLocationTable=Object.freeze(Object.fromEntries(Object.entries(this.locationTable).map((([e,t])=>[t,e]))))}exportPackage(){return{checksum:this.checksum,item_name_to_id:{...this.itemTable},location_name_to_id:{...this.locationTable}}}}class w{#e;#s=new Map;#r=new Map;#o=new Set;constructor(e){this.#e=e,this.#e.socket.on("roomInfo",(e=>{this.#s.clear(),this.#r.clear(),this.#o.clear(),this.#s.set("Archipelago",this.#a());for(const t in e.datapackage_checksums)this.#r.set(t,e.datapackage_checksums[t]),this.#o.add(t)}))}findPackage(e){return this.#s.get(e)??null}async fetchPackage(e=[],t=!0){0===e.length&&(e=Array.from(this.#o)),e=e.filter((e=>!!this.#o.has(e)&&this.#s.get(e)?.checksum!==this.#r.get(e)));const n={games:{}};for(const t of e){const e={cmd:"GetDataPackage",games:[t]},[i]=await this.#e.socket.send(e).wait("dataPackage");n.games[t]=i.data.games[t]}return t&&this.importPackage(n),n}importPackage(e){for(const t in e.games)this.#s.set(t,new b(t,e.games[t])),this.#r.set(t,e.games[t].checksum)}exportPackage(){return{games:this.#s.entries().reduce(((e,[t,n])=>(e[t]=n.exportPackage(),e)),{})}}lookupItemName(e,t,n=!0){const i=`Unknown Item ${t}`,s=this.findPackage(e);if(!s)return n?i:void 0;const r=s.reverseItemTable[t];return n&&void 0===r?i:r}lookupLocationName(e,t,n=!0){const i=`Unknown Location ${t}`,s=this.findPackage(e);if(!s)return n?i:void 0;const r=s.reverseLocationTable[t];return n&&void 0===r?i:r}#a(){return new b("Archipelago",{checksum:"ac9141e9ad0318df2fa27da5f20c50a842afeecb",item_name_to_id:{Nothing:-1},location_name_to_id:{"Cheat Console":-1,Server:-2}})}}class x{#e;#l=[];#c;#u;constructor(e,t,n){this.#e=e,this.#c=t,this.#u=n}replace(e){return this.#l.push({operation:"replace",value:e}),this}default(){return this.#l.push({operation:"default",value:null}),this}add(e){return this.#l.push({operation:"add",value:e}),this}multiply(e){return this.#l.push({operation:"mul",value:e}),this}power(e){return this.#l.push({operation:"pow",value:e}),this}remainder(e){return this.#l.push({operation:"mod",value:e}),this}floor(){return this.#l.push({operation:"floor",value:null}),this}ceiling(){return this.#l.push({operation:"ceil",value:null}),this}max(e){return this.#l.push({operation:"max",value:e}),this}min(e){return this.#l.push({operation:"min",value:e}),this}and(e){return this.#l.push({operation:"and",value:e}),this}or(e){return this.#l.push({operation:"or",value:e}),this}xor(e){return this.#l.push({operation:"xor",value:e}),this}leftShift(e){return this.#l.push({operation:"left_shift",value:e}),this}rightShift(e){return this.#l.push({operation:"right_shift",value:e}),this}remove(e){return this.#l.push({operation:"remove",value:e}),this}pop(e){return this.#l.push({operation:"pop",value:e}),this}update(e){return this.#l.push({operation:"update",value:e}),this}async commit(e=!1){const t=_(),n={cmd:"Set",default:this.#u,key:this.#c,operations:this.#l,want_reply:e,uuid:t};if(this.#e.socket.send(n),!e)return;const[i]=await this.#e.socket.wait("setReply",(e=>e.uuid===t));return i.value}}class k{#e;#d={};#h={};constructor(e){this.#e=e,this.#e.socket.on("disconnected",(()=>{this.#d={},this.#h={}})).on("setReply",(e=>{this.#d[e.key]=e.value;const t=this.#h[e.key];t&&t.forEach((t=>t(e.key,e.value,e.original_value)))})).on("connected",(()=>{if(this.#e.options.debugLogVersions){const e=`${this.#e.game}:${g}:${navigator?.userAgent}`;this.prepare("archipelago.js__runtimes",{}).default().update({[e]:!0}).commit(!1)}}))}get store(){return structuredClone(this.#d)}async fetch(e,t=!1){let n="string"==typeof e?[e]:e;if(t){const e=n.filter((e=>void 0===this.#d[e]));e.length>0&&this.#e.socket.send({cmd:"SetNotify",keys:e})}let i={};if(n=n.filter((e=>{const t=structuredClone(this.#d[e]),n=void 0!==t;return n&&(i[e]=t),!n})),n.length>0){const e=await this.#p(n);i={...i,...e}}return t&&(this.#d={...this.#d,...i}),"string"==typeof e?i[e]:i}async notify(e,t){return e.forEach((e=>{this.#h[e]??=[],this.#h[e].push(t)})),this.fetch(e,!0)}prepare(e,t){if(e.startsWith("_read_"))throw TypeError("Cannot manipulate read only keys.");return new x(this.#e,e,t)}async fetchItemNameGroups(e){return await this.fetch([`_read_item_name_groups_${e}`],!0)}async fetchLocationNameGroups(e){return await this.fetch([`_read_location_name_groups_${e}`],!0)}async#p(e){const t=_(),[n]=await this.#e.socket.send({cmd:"Get",keys:e,uuid:t}).wait("retrieved",(e=>e.uuid===t));return n.keys}}class z{#f={};addEventListener(e,t,n=!1){this.#f[e]??=[],this.#f[e].push([t,n])}removeEventListener(e,t){const n=this.#f[e];n&&n.length>0&&(this.#f[e]=n.filter((([e])=>e!==t)))}dispatchEvent(e,t){const n=this.#f[e]??[];for(const[i,s]of n)i(...t),s&&this.removeEventListener(e,i)}}class S{#f=new z;on(e,t){return this.#f.addEventListener(e,t),this}off(e,t){return this.#f.removeEventListener(e,t),this}async wait(e,t=()=>!0){return new Promise((n=>{const i=(...s)=>{t(...s)&&(this.#f.removeEventListener(e,i),n(s))};this.#f.addEventListener(e,i)}))}emit(e,t){this.#f.dispatchEvent(e,t)}}class P extends S{#e;#m=Number.MIN_SAFE_INTEGER;constructor(e){super(),this.#e=e,this.#e.socket.on("bounced",(e=>{if(e.tags?.includes("DeathLink")&&e.data.time&&e.data.source){const t=e.data;if(t.time===this.#m)return;this.#m=t.time,this.emit("deathReceived",[t.source,1e3*t.time,t.cause])}}))}get enabled(){return this.#e.arguments.tags.includes("DeathLink")}enableDeathLink(){this.#e.arguments.tags.includes("DeathLink")||this.#e.updateTags([...this.#e.arguments.tags,"DeathLink"])}disableDeathLink(){this.#e.arguments.tags.includes("DeathLink")&&this.#e.updateTags(this.#e.arguments.tags.filter((e=>"DeathLink"!==e)))}sendDeathLink(e,t){if(!this.#e.authenticated)throw new p("Cannot send death links before connecting and authenticating.");if(!this.enabled)return;this.#m=Math.ceil(Date.now()/1e3);const n={source:e,cause:t,time:this.#m};this.#e.bounce({tags:["DeathLink"]},n)}}class C{#e;#g;#t;constructor(e,t){this.#e=e,this.#g=t,this.#t=new y(this.#e,{item:t.item,location:t.location,player:t.finding_player,flags:t.item_flags},this.#e.players.findPlayer(t.finding_player),this.#e.players.findPlayer(t.receiving_player))}get item(){return this.#t}get found(){return this.#g.found}get entrance(){return this.#g.entrance||"Vanilla"}}class E extends S{#e;#_=[];#v=[];constructor(e){super(),this.#e=e,this.#e.socket.on("receivedItems",(e=>{let t=e.index;const n=e.items.length,i=[...e.items];for(;i.length>0;){const e=i.shift();this.#_[t++]=new y(this.#e,e,this.#e.players.findPlayer(e.player),this.#e.players.self)}this.emit("itemsReceived",[this.#_.slice(e.index,e.index+n),e.index])})).on("connected",(()=>{this.#v=[],this.#_=[],this.#e.storage.notify([`_read_hints_${this.#e.players.self.team}_${this.#e.players.self.slot}`],this.#y.bind(this)).then((e=>{const t=e[`_read_hints_${this.#e.players.self.team}_${this.#e.players.self.slot}`];this.#v=t.map((e=>new C(this.#e,e))),this.emit("hintsInitialized",[this.#v])})).catch((e=>{throw e}))}))}get received(){return[...this.#_]}get hints(){return[...this.#v]}get count(){return this.#_.length}#y(e,t){for(let e=0;e<t.length;e++)void 0===this.#v[e]?(this.#v[e]=new C(this.#e,t[e]),this.emit("hintReceived",[this.#v[e]])):this.#v[e].found!==t[e].found&&(this.#v[e]=new C(this.#e,t[e]),this.emit("hintFound",[this.#v[e]]))}}class A{client;part;constructor(e,t){this.client=e,this.part=t}toString(){return this.text}}class j extends A{part;type="item";item;constructor(e,t,n,i){super(e,t);const s=e.players.findPlayer(t.player,i.team);this.part=t,this.item=new y(e,n,s,i)}get text(){return this.item.name}}class L extends A{#b;part;type="location";id;constructor(e,t){super(e,t);const n=e.players.findPlayer(t.player),i=e.package.findPackage(n.game);this.part=t,"location_name"===t.type?(this.#b=t.text,this.id=i.locationTable[t.text]):(this.id=parseInt(t.text),this.#b=e.package.lookupLocationName(n.game,this.id,!0))}get text(){return this.#b}}class O extends A{part;type="color";color;constructor(e,t){super(e,t),this.part=t,this.color=t.color}get text(){return this.part.text}}class $ extends A{part;type;constructor(e,t){super(e,t),this.part=t,"entrance_name"===this.part.type?this.type="entrance":this.type="text"}get text(){return this.part.text}}class I extends A{part;type="player";player;constructor(e,t){if(super(e,t),this.part=t,"player_id"===t.type)this.player=e.players.findPlayer(parseInt(t.text));else{const n=e.players.teams[e.players.self.team].find((e=>e.name===t.text));if(!n)throw new Error(`Cannot find player under name: ${t.text}`);this.player=n}}get text(){return this.player.alias}}class T extends S{#e;#w=[];get log(){return[...this.#w]}constructor(e){super(),this.#e=e,this.#e.socket.on("printJSON",this.#x.bind(this))}async say(e){if(!this.#e.authenticated)throw new p("Cannot send chat messages without being authenticated.");const t={cmd:"Say",text:e=e.trim()};this.#e.socket.send(t),await this.wait("chat",(t=>t===e))}#x(e){const t=[];for(const n of e.data)switch(n.type){case"item_id":case"item_name":{const i=e;let s;s="ItemCheat"===i.type?this.#e.players.findPlayer(i.receiving,i.team):this.#e.players.findPlayer(i.receiving),t.push(new j(this.#e,n,i.item,s));break}case"location_id":case"location_name":t.push(new L(this.#e,n));break;case"color":t.push(new O(this.#e,n));break;case"player_id":case"player_name":t.push(new I(this.#e,n));break;default:t.push(new $(this.#e,n))}const n=t.map((e=>e.text)).join();switch(this.#e.options.maximumMessages>=1&&(this.log.push({text:n,nodes:t}),this.log.splice(0,this.log.length-this.#e.options.maximumMessages)),e.type){case"ItemSend":{const i=this.#e.players.findPlayer(e.item.player),s=this.#e.players.findPlayer(e.receiving),r=new y(this.#e,e.item,i,s);this.emit("itemSent",[n,r,t]);break}case"ItemCheat":{const i=this.#e.players.findPlayer(e.item.player,e.team),s=this.#e.players.findPlayer(e.receiving,e.team),r=new y(this.#e,e.item,i,s);this.emit("itemCheated",[n,r,t]);break}case"Hint":{const i=this.#e.players.findPlayer(e.item.player),s=this.#e.players.findPlayer(e.receiving),r=new y(this.#e,e.item,i,s);this.emit("itemHinted",[n,r,e.found,t]);break}case"Join":{const i=this.#e.players.findPlayer(e.slot,e.team);this.emit("connected",[n,i,e.tags,t]);break}case"Part":{const i=this.#e.players.findPlayer(e.slot,e.team);this.emit("disconnected",[n,i,t]);break}case"Chat":{const n=this.#e.players.findPlayer(e.slot,e.team);this.emit("chat",[e.message,n,t]);break}case"ServerChat":this.emit("serverChat",[e.message,t]);break;case"TagsChanged":{const i=this.#e.players.findPlayer(e.slot,e.team);this.emit("tagsUpdated",[n,i,e.tags,t]);break}case"Tutorial":this.emit("tutorial",[n,t]);break;case"CommandResult":this.emit("userCommand",[n,t]);break;case"AdminCommandResult":this.emit("adminCommand",[n,t]);break;case"Goal":{const i=this.#e.players.findPlayer(e.slot,e.team);this.emit("goaled",[n,i,t]);break}case"Release":{const i=this.#e.players.findPlayer(e.slot,e.team);this.emit("released",[n,i,t]);break}case"Collect":{const i=this.#e.players.findPlayer(e.slot,e.team);this.emit("collected",[n,i,t]);break}case"Countdown":this.emit("countdown",[n,e.countdown,t])}this.emit("message",[n,t])}}class M{#e;#k;constructor(e,t){this.#e=e,this.#k=t}toString(){return this.alias}get name(){return this.#k.name}get alias(){return this.#k.alias}get game(){return 0===this.slot?"Archipelago":this.#z.game}get type(){return 0===this.slot?c.spectator:this.#z.type}get team(){return this.#k.team}get slot(){return this.#k.slot}get members(){return this.type!==c.group?[]:this.#e.players.teams[this.team].filter((e=>this.#z.group_members.includes(e.slot)))}get groups(){return 0===this.slot?[]:this.#e.players.teams[this.team].filter((e=>0!==e.slot&&this.#e.players.slots[e.slot].group_members.includes(this.slot)))}async fetchStatus(){return this.type===c.group?r.goal:await this.#e.storage.fetch(`_read_client_status_${this.team}_${this.slot}`)??0}async fetchSlotData(){return await this.#e.storage.fetch(`_read_slot_data_${this.slot}`)}async fetchHints(){return(await this.#e.storage.fetch(`_read_hints_${this.team}_${this.slot}`)).map((e=>new C(this.#e,e)))}get#z(){return this.#e.players.slots[this.slot]}}class N extends S{#e;#S=[];#P={};#C=0;#E=0;constructor(e){super(),this.#e=e,this.#e.socket.on("connected",(e=>{this.#P=Object.freeze(e.slot_info),this.#S=[],this.#C=e.slot,this.#E=e.team;for(const t of e.players)this.#S[t.team]??=[{team:t.team,slot:0,name:"Archipelago",alias:"Archipelago"}],this.#S[t.team][t.slot]=t})).on("roomUpdate",(e=>{if(e.players)for(const t of e.players)if(this.#S[t.team][t.slot].alias!==t.alias){const e=this.#S[t.team][t.slot].alias;this.#S[t.team][t.slot]=t,this.emit("aliasUpdated",[new M(this.#e,t),e,t.alias])}}))}get self(){if(0===this.#C)throw new Error("Cannot lookup own player object when client has never connected to a server.");return new M(this.#e,this.#S[this.#E][this.#C])}get slots(){return this.#P}get teams(){const e=[];for(let t=0;t<this.#S.length;t++){e[t]=[];for(let n=0;n<this.#S[t].length;n++)e[t].push(new M(this.#e,this.#S[t][n]))}return e}findPlayer(e,t){if(void 0===t&&(t=this.#e.players.self.team),this.#S[t])return new M(this.#e,this.#S[t][e])}}class D extends S{#e;#A={major:-1,minor:-1,build:-1};#j={major:-1,minor:-1,build:-1};#o=[];#L=[];#O="";#$=!1;#I=0;#T=0;#M=0;#N={release:0,collect:0,remaining:0};#D=[];#R=[];#F=!1;get serverVersion(){return{...this.#A}}get generatorVersion(){return{...this.#j}}get games(){return[...this.#o]}get tags(){return[...this.#L]}get seedName(){return this.#O}get password(){return this.#$}get permissions(){return{...this.#N}}get hintPoints(){return this.#I}get hintCost(){return this.hintCostPercentage>0?Math.max(1,Math.floor(this.hintCostPercentage*this.allLocations.length*.01)):0}get hintCostPercentage(){return this.#T}get locationCheckPoints(){return this.#M}get missingLocations(){return[...this.#D].sort()}get checkedLocations(){return[...this.#R].sort()}get allLocations(){return[...this.#D,...this.#R].sort()}get race(){return this.#F}constructor(e){super(),this.#e=e,this.#e.socket.on("roomInfo",(e=>{this.#A={major:e.version.major,minor:e.version.minor,build:e.version.build},this.#j={major:e.generator_version.major,minor:e.generator_version.minor,build:e.generator_version.build},this.#L=e.tags,this.#o=e.games,this.#O=e.seed_name,this.#$=e.password,this.#N=e.permissions,this.#T=e.hint_cost,this.#M=e.location_check_points})).on("connected",(e=>{this.#D=e.missing_locations,this.#R=e.checked_locations,this.emit("locationsChecked",[this.checkedLocations]),this.#I=e.hint_points,this.emit("hintPointsUpdated",[0,e.hint_points])})).on("roomUpdate",(e=>{if(void 0!==e.hint_cost){const[t,n]=[this.hintCost,this.hintCostPercentage];this.#T=e.hint_cost,this.emit("hintCostUpdated",[t,this.hintCost,n,this.hintCostPercentage])}if(void 0!==e.hint_points){const t=this.#I;this.#I=e.hint_points,this.emit("hintPointsUpdated",[t,this.hintPoints])}if(void 0!==e.location_check_points){const t=this.#M;this.#M=e.location_check_points,this.emit("locationCheckPointsUpdated",[t,this.locationCheckPoints])}if(void 0!==e.password&&(this.#$=e.password,this.emit("passwordUpdated",[this.password])),void 0!==e.permissions){const t=this.#N;this.#N=e.permissions,this.emit("permissionsUpdated",[t,this.permissions])}void 0!==e.checked_locations&&(this.#R=[...this.#R,...e.checked_locations],this.#D=this.missingLocations.filter((t=>!e.checked_locations?.includes(t))),this.emit("locationsChecked",[e.checked_locations]))}))}}class R extends S{#U=null;#B=!1;constructor(){super()}get connected(){return this.#B}get url(){return this.#U?.url??""}send(...e){if(this.#U)return this.#U.send(JSON.stringify(e)),this.emit("sentPackets",[e]),this;throw new u("Unable to send packets to the server; not connected to a server.")}async connect(e){if(this.disconnect(),"string"==typeof e){if(!/^([a-zA-Z]+:)\/\/[A-Za-z0-9_.~\-:]+/i.test(e))try{return await this.connect(new URL(`wss://${e}`))}catch{return await this.connect(new URL(`ws://${e}`))}e=new URL(e)}if(e.port=e.port||"38281","wss:"!==e.protocol&&"ws:"!==e.protocol)throw new TypeError("Unexpected protocol. Archipelago only supports the ws:// and wss:// protocols.");try{return new Promise(((t,n)=>{const i=this.#W();if(null===i)throw new u("Unable to find a suitable WebSocket API in the current runtime.");this.#U=new i(e),this.#U.onmessage=this.#V.bind(this),this.#U.onclose=()=>{this.disconnect(),n(new u("Failed to connect to Archipelago server."))},this.#U.onerror=()=>{this.disconnect(),n(new u("Failed to connect to Archipelago server."))},this.#U.onopen=()=>{this.wait("roomInfo").then((([e])=>{if(this.#B=!0,this.#U)return this.#U.onclose=this.disconnect.bind(this),this.#U.onerror=this.disconnect.bind(this),void t(e);this.disconnect(),n(new u("Failed to connect to Archipelago server."))})).catch((e=>{throw e}))}}))}catch(e){throw this.disconnect(),e}}disconnect(){this.connected&&(this.#B=!1,this.#U?.close(),this.#U=null,this.emit("disconnected",[]))}#V(e){const t=JSON.parse(e.data);for(const e of t){switch(e.cmd){case"ConnectionRefused":this.emit("connectionRefused",[e]);break;case"Bounced":this.emit("bounced",[e,e.data]);break;case"Connected":this.emit("connected",[e]);break;case"DataPackage":this.emit("dataPackage",[e]);break;case"InvalidPacket":this.emit("invalidPacket",[e]);break;case"LocationInfo":this.emit("locationInfo",[e]);break;case"PrintJSON":this.emit("printJSON",[e]);break;case"ReceivedItems":this.emit("receivedItems",[e]);break;case"Retrieved":this.emit("retrieved",[e]);break;case"RoomInfo":this.emit("roomInfo",[e]);break;case"RoomUpdate":this.emit("roomUpdate",[e]);break;case"SetReply":this.emit("setReply",[e])}this.emit("receivedPacket",[e])}}#W(){let e=null;return"undefined"!=typeof window?e=window.WebSocket||window.MozWebSocket:"undefined"!=typeof global?e=global.WebSocket||global.MozWebSocket:"undefined"!=typeof self?e=self.WebSocket||self.MozWebSocket:"undefined"!=typeof WebSocket?e=WebSocket:"undefined"!=typeof MozWebSocket&&(e=MozWebSocket),e}}class F{#q=!1;#H=v;#b="";#G="";socket=new R;package=new w(this);storage=new k(this);room=new D(this);players=new N(this);items=new E(this);messages=new T(this);deathLink=new P(this);options;get authenticated(){return this.socket.connected&&this.#q}get name(){return this.#b}get game(){return this.#G}get arguments(){return{...this.#H}}constructor(e){this.options=e?{...f,...e}:{...f},this.socket.on("disconnected",(()=>{this.#q=!1})).on("sentPackets",(e=>{for(const t of e)"ConnectUpdate"===t.cmd&&(this.#H.tags=t.tags,this.#H.items=t.items_handling)}))}async login(e,t,n="",i){if(""===t)throw new d("Provided slot name cannot be blank.","name",t);this.#H=i?{...v,...i}:{...v};const s=new Set(this.arguments.tags);n||s.has("HintGame")||s.has("Tracker")||s.has("TextOnly")||s.add("TextOnly"),this.#H.tags=Array.from(s);const r={cmd:"Connect",name:t,game:n,password:this.arguments.password,slot_data:this.arguments.slotData,items_handling:this.arguments.items,uuid:this.arguments.uuid,tags:this.arguments.tags,version:{...this.arguments.version,class:"Version"}};return await this.socket.connect(e),this.options.autoFetchDataPackage&&await this.package.fetchPackage(),new Promise(((e,t)=>{const n=setTimeout((()=>t(new u("Server failed to respond in time."))),this.options.timeout),i=t=>{this.#q=!0,this.#G=t.slot_info[t.slot].game,this.#b=t.slot_info[t.slot].name,this.socket.off("connected",i).off("connectionRefused",s),clearTimeout(n),e(t.slot_data)},s=e=>{this.socket.off("connected",i).off("connectionRefused",s),clearTimeout(n),t(new h(`Connection was refused by the server. Reason(s): [${e.errors?.join(", ")}`,e.errors??[]))};this.socket.on("connected",i.bind(this)).on("connectionRefused",s.bind(this)).send(r)}))}updateStatus(e){if(!this.authenticated)throw new p("Cannot update status while not connected and authenticated.");this.socket.send({cmd:"StatusUpdate",status:e})}goal(){this.updateStatus(r.goal)}updateTags(e){if(!this.authenticated)throw new p("Cannot update tags while not connected and authenticated.");this.socket.send({cmd:"ConnectUpdate",tags:e,items_handling:this.arguments.items})}updateItemsHandling(e){if(!this.authenticated)throw new p("Cannot update tags while not connected and authenticated.");this.socket.send({cmd:"ConnectUpdate",tags:this.arguments.tags,items_handling:e})}check(...e){if(!this.authenticated)throw new p("Cannot check locations while not connected and authenticated.");e=e.filter((e=>this.room.missingLocations.includes(e))),this.socket.send({cmd:"LocationChecks",locations:e})}async scout(e,t=0){if(!this.authenticated)throw new p("Cannot scout locations while not connected and authenticated.");e=e.filter((e=>this.room.allLocations.includes(e)));const[n]=await this.socket.send({cmd:"LocationScouts",create_as_hint:t,locations:e}).wait("locationInfo",(t=>t.locations.map((e=>e.location)).toSorted().join(",")===e.toSorted().join(",")));return n.locations.map((e=>new y(this,e,this.players.self,this.players.findPlayer(e.player))))}bounce(e,t){if(!this.authenticated)throw new p("Cannot send bounces while not connected and authenticated.");this.socket.send({cmd:"Bounce",data:t,games:e.games??[],slots:e.slots??[],tags:e.tags??[]})}}}},t={};function n(i){var s=t[i];if(void 0!==s)return s.exports;var r=t[i]={exports:{}};return e[i](r,r.exports,n),r.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};const{Client:i,ITEMS_HANDLING_FLAGS:s,SERVER_PACKET_TYPE:r,LocationsManager:o,ReceivedItemsPacket:a,clientStatuses:l,itemsHandlingFlags:c}=n(131),u=n(705).A,d=n(291),{GameSave:h,getFile:p,getFileList:f,openDatabase:m}=d,{config:g}=n(456),{genres:_,genreInfo:v}=n(326);let y;document.addEventListener("alpine:init",(function(){console.log("puzzles.html: onInit"),async function(){await m(),console.log("Savedata open"),await async function(){const e=u.store("gamesaves");e.list=await f();let t=new h({id:-1,filename:"Freeplay",puzzles:_.filter((e=>!0)),puzzleLocked:_.map((e=>!1))});e.list.unshift(t),e.loadFile(t)}(),console.log("File list loaded")}(),u.store("puzzleList",{entries:[],sortedEntries:[],currentIndex:-1,current:null,solveCount:0,solveTarget:null,finished:!1,sortBySolved:!1,selectPuzzle(e){if(!e)return this.currentIndex=-1,void(this.current=null);e.locked&&!u.store("debugMode")||e.index==this.currentIndex||(this.currentIndex=e.index,this.current=e,e.puzzleId?C(e.genre,e.puzzleId,!0,e.index):e.puzzleSeed?C(e.genre,e.puzzleSeed,!0,e.index):C(e.genre,"",!1))},markSolved(e){if(e??=this.current,e){e.onSolve(),e==this.current&&O();const t=u.store("gamesaves");e.index&&t.current&&(t.current.puzzleSolved[e.index-1]=!0,t.current.save()),this.resort()}},resort(){function e(e,t){return e<t?-1:e>t?1:0}function t(e){return e.solved?1:e.locked?2:0}var n=this.entries.slice();this.sortBySolved?n.sort(((n,i)=>e(t(n),t(i))||e(n.id,i.id))):n.sort(((t,n)=>e(t.id,n.id))),this.sortedEntries=n,this.solveCount=this.entries.reduce(((e,t)=>t.solved?e+1:e),0)},onFinishClick(){null!==this.solveTarget&&this.solveCount>=this.solveTarget&&(w.updateStatus(l.goal),this.finished=!0,u.store("gamesaves").markFinished())}}),u.store("puzzleList").resort(),u.store("puzzleState",{onSolve(){this.solved=!0},undoEnabled:!1,redoEnabled:!1,solveEnabled:!0,primaryKeyLabel:"",secondaryKeyLabel:"",loaded:!1,solved:!1,status:0,genre:null,genreInfo:v.none,gameId:"",gameSeed:"",reset(){this.solved=!1,this.undoEnabled=!1,this.redoEnabled=!1,this.solveEnabled=!0,this.primaryKeyLabel="",this.secondaryKeyLabel="",this.loaded=!1,this.solved=!1,this.status=0,this.genre=null,this.genreInfo=v.none,this.gameId="",this.gameSeed=""}}),u.store("singleMode",!1),u.store("puzzlePresets",[]),u.store("puzzleDialog",{controls:[],visible:!1,addControl(e,t,n,i,s){"choice"==t?this.controls.push({index:e,type:t,title:n,value:i,choices:s}):this.controls.push({index:e,type:t,title:n,value:i})},confirm:j,cancel:L,dismiss(){this.controls=[],this.visible=!1}}),u.store("errorMessage",{message:"",visible:!1,show(e){this.message=e,this.visible=!0},dismiss(){this.visible=!1}}),u.store("status",{message:"",visible:!1,set(e){this.message=e,this.visible=!0},hide(){this.message="",this.visible=!1}}),u.store("debugLoader",{genre:"net",id:"",singleMode:!1,load(){u.store("puzzleList").selectPuzzle(null),C(this.genre,this.id,this.singleMode)}}),u.store("connectionInfo",{hostname:g.defaultHost,port:"38281",player:"Player1",password:"",connect(){!async function(e,t,n,i){const s=u.store("gamesaves");s.connecting=!0,H(),s.apError=!1;try{await B(e,t,n,i)}catch(e){return alert("Couldn't connect to Archipelago server."),console.error("Couldn't connect to Archipelago server"),console.error(e),s.apError=!0,void(s.connecting=!1)}let r=b.file_version??0;console.log(`file_version = ${b.file_version}`),console.log(`world_version = ${b.world_version}`),r>1&&alert(`World is version ${b.world_version}, which is not compatible with this web client version. Some features may not work as expected.`);let o=new h({host:e,port:t,player:n,password:i,puzzles:b.puzzles,baseSeed:""+b.world_seed,solveTarget:b.solve_target});await E(),q(o),await o.save(),x=!0,s.connecting=!1,s.list.push(o),s.current=o,W(),T()}(this.hostname,+this.port,this.player,this.password)},replaceConnectionInfo(){let e=u.store("gamesaves").current,t={host:this.hostname,port:+this.port,player:this.player,password:this.password};e&&-1!=e.id&&M(e,!1,t)}}),u.store("gamesaves",{list:[],current:null,apError:!1,connecting:!1,connected:!1,loadFile(e,t){M(e,t)},deleteFile(e){confirm(`${e.toString()}: Delete this file?`)&&async function(e){await e.deleteFile();const t=u.store("gamesaves");u.store("puzzleList");let n=t.list.indexOf(e);n>-1&&t.list.splice(n,1),t.current==e&&(E(),t.current=null,q(null))}(e)},markFinished(){this.current&&(this.current.finished=!0,this.current.save())}}),u.store("genres",_),u.store("config",g),P(),y=document.getElementById("puzzleframe")}));let b,w,x=!1,k={};class z{constructor(e){this.genre=e.genre,this.params=e.params,this.desc="",this.index=e.index,this.puzzleId=e.puzzleId,this.puzzleSeed=e.puzzleSeed,this.solved=e.solved??!1,this.collected=e.collected??!1,this.locked=e.locked??!1,this.item=e.item,this.state="",this.updateDescription(),this.updateState()}updateDescription(){let e=v[this.genre].name;this.params?this.desc=`${e}: ${this.params}`:this.desc=e}updateState(){this.locked?this.state="locked":this.solved?this.state="solved":this.state="unlocked"}onSolve(){if(this.solved=!0,this.updateState(),x){let e=V(`Puzzle ${this.index} Reward`);w.check(e)}}static fromArchipelagoString(e,t,n,i){i??={};let s=/^(?<genre>[^:\n]*)(:(?<params>[^:#\n]*)((?<separator>[:#])?(?<seedOrId>.*)))?$/.exec(e),r=s.groups.genre,o=s.groups.params,a=s.groups.separator,l=s.groups.seedOrId;if(i.genre=r,i.params=o,i.index=n,":"==a)i.puzzleSeed=`${o}:${l}`;else if("#"==a)i.puzzleId=`${o}#${l}`;else{let e=""+n;e=e.padStart(3,"0");let s=`${e}${t}`;i.puzzleSeed=`${o}#${s}`}return new z(i)}static fromPuzzlesString(e,t,n,i){if(i??={},t){let e=/^([^:#]*)([:#]?)/.exec(t);i.params=e[1],":"==e[2]?i.puzzleId=t:i.puzzleSeed=t}else i.params="";return i.index??=n,i.genre=e,new z(i)}}function S(e,...t){y&&y.contentWindow.postMessage([e,...t])}function P(){u.store("puzzleState").reset(),u.store("puzzlePresets",[]),u.store("puzzleDialog").dismiss(),u.store("status").hide(),u.store("errorMessage").dismiss()}async function C(e,t,n,i){let s=u.store("debugLoader"),r=u.store("puzzleState");e||(t=void 0,n=!0),P(),s.genre=e,s.id=t,s.singleMode=!!n,r.genre=e,r.genreInfo=v[e||"none"],u.store("singleMode",!!n);const o=u.store("gamesaves");let a=!1;o.current&&null!=i&&await o.current.getPuzzleSave(i)&&(a=!0);let l=[];e&&l.push({key:"g",value:e}),t&&!a&&l.push({key:"i",value:t}),!n&&e||l.push({key:"s",value:"true"});let c=l.map((e=>`${e.key}=${encodeURIComponent(e.value)}`)).join("&");y.src=null,y.src=`puzzleframe.html?${c}`,y.width=0,y.height=0}async function E(){return await C("")}const A={ready:function(){console.log("puzzles.html: puzzleframe ready")},js_init_puzzle:function(){},js_post_init:function(){$(),u.store("puzzleState").loaded=!0},js_update_permalinks:function(e,t){let n=u.store("puzzleState");n.gameId=e,n.gameSeed=t},js_enable_undo_redo:function(e,t){u.store("puzzleState").undoEnabled=!!e,u.store("puzzleState").redoEnabled=!!t},js_remove_solve_button:function(){u.store("puzzleState").solveEnabled=!1},js_update_status:function(e){let t=u.store("puzzleState");t.status=e,1!=t.status||t.solved||(console.log("woo hoo"),t.solved=!0,u.store("puzzleList").markSolved())},js_update_key_labels:function(e,t){let n=u.store("puzzleState");n.primaryKeyLabel=e,n.secondaryKeyLabel=t},js_add_preset:function(e,t,n){let i={menuId:e,name:t,id:n};u.store("puzzlePresets").push(i)},js_add_preset_submenu:function(){},js_select_preset:function(e){},js_dialog_init:function(){u.store("puzzleDialog").controls=[]},js_dialog_string:function(e,t,n){u.store("puzzleDialog").addControl(e,"string",t,n)},js_dialog_choices:function(e,t,n,i){let s=n.split(n[0]);s.shift(),u.store("puzzleDialog").addControl(e,"choice",t,i,s)},js_dialog_boolean:function(e,t,n){u.store("puzzleDialog").addControl(e,"boolean",t,!!n)},js_dialog_launch:function(){u.store("puzzleDialog").visible=!0},js_dialog_cleanup:function(){u.store("puzzleDialog").dismiss()},js_canvas_set_statusbar:function(e){u.store("status").set(e)},js_canvas_remove_statusbar:function(){u.store("status").hide()},js_canvas_set_size:function(e,t){y.width=e/window.devicePixelRatio,y.height=t/window.devicePixelRatio},js_error_box:function(e){u.store("errorMessage").show(e)},js_focus_canvas:function(){},savePuzzleDataCallback:function(e){console.log("Save file ready");const t=u.store("gamesaves"),n=u.store("puzzleList");t.current&&n.current&&t.current.setPuzzleSave(n.current.index,e)}};function j(){let e=u.store("puzzleDialog");for(let t of e.controls)switch(t.type){case"string":S("dialogReturnString",t.index,t.value);break;case"choice":S("dialogReturnInt",t.index,t.value);break;case"boolean":S("dialogReturnInt",t.index,t.value?1:0)}S("dialogConfirm")}function L(){S("dialogCancel")}function O(){S("savePuzzleData")}async function $(){const e=u.store("gamesaves"),t=u.store("puzzleList");if(!e.current||!t.current)return;let n=await e.current.getPuzzleSave(t.current.index);n&&S("loadPuzzleData",n)}function I(e){return w.items.received.findIndex((t=>t.id==e))>-1}function T(){const e=u.store("puzzleList");if(!x)return void e.resort();let t=!0,n=u.store("gamesaves").current,i=!1,s={},r=!1;for(let a of e.entries){let e=!1,l=(o=`Puzzle ${a.index}`,w.package.findPackage("Simon Tatham's Portable Puzzle Collection").itemTable[o]),c=V(`Puzzle ${a.index} Reward`);!a.collected&&w.room.checkedLocations.includes(c)?(a.collected=!0,e=!0):a.collected||(t=!1),a.locked&&I(l)&&(a.locked=!1,e=!0,n&&n.puzzleLocked[a.index-1]&&(n.puzzleLocked[a.index-1]=!1,i=!0)),e&&a.updateState(),a.solved&&!(a.index in k)&&(s[a.index]=1,k[a.index]=1,r=!0)}var o;if(r){let e=w.players.self.slot;w.storage.prepare(`sgtpuzzles_solves_${e}`,{}).update(s).commit()}e.resort(),i&&n.save()}async function M(e,t,n){const i=u.store("gamesaves");i.connecting=!0,i.current=e,H(),i.apError=!1;let s,r,o,a,l=!1;if(n?(s=n.host??e.host,r=n.port??e.port,o=n.player??e.player,a=n.password??e.password):(s=e.host,r=e.port,o=e.player,a=e.password),s)try{await B(s,r,o,a),l=!0}catch(e){n?alert("Couldn't connect to Archipelago server. Reload this file to connect with previous information."):alert("Couldn't connect to Archipelago server. (You can still solve unlocked puzzles on this file.)"),i.apError=!0,console.error(e)}l&&function(){if(e.baseSeed!=""+b.world_seed)return!0;if(e.puzzles.length!=b.puzzles.length)return!0;for(let t=0;t<e.puzzles.length;t++)if(e.puzzles[t]!=b.puzzles[t])return!0;return!1}()&&(n?alert("The Archipelago server data doesn't match this save file. Reload this file to connect with previous information."):alert("The Archipelago server data doesn't match this save file. (You can still solve unlocked puzzles.)"),H(),l=!1,i.apError=!0),n&&l&&(e.host=s,e.port=r,e.player=o,e.password=a,e.updateDescription(),e.save()),await E(),q(e,t),l&&(x=!0,i.connected=!0,W()),i.connecting=!1,T()}function N(e){x&&T()}function D(e){console.log(e)}function R(e){let t=`sgtpuzzles_solves_${w.players.self.slot}`;e.key==t&&U(e.value)}function F(e){let t=`sgtpuzzles_solves_${w.players.self.slot}`;console.log("KeysRetrieved",e),e.keys[t]&&U(e.keys[t])}function U(e){console.log(e);let t=u.store("puzzleList"),n={};Object.assign(n,k);for(let i in e)i in n||(console.log(`adding remote solve ${i}`),k[i]=e[i],t.markSolved(t.entries[i-1]))}async function B(e,t,n,s){w||(w=new i,window.client=w,w.socket.on("receivedPacket",D),w.socket.on("receivedItems",N),w.socket.on("roomUpdate",T),w.socket.on("setReply",R),w.socket.on("retrieved",F)),k={},console.log("connecting to AP...");const r={password:s??""};let o=`${e}:${t}`;b=await w.login(o,n,"Simon Tatham's Portable Puzzle Collection",r),console.log("connected to AP"),T()}function W(){let e=`sgtpuzzles_solves_${w.players.self.slot}`;w.socket.send({cmd:"SetNotify",keys:[e]}),w.socket.send({cmd:"Get",keys:[e]})}function V(e){return w.package.findPackage("Simon Tatham's Portable Puzzle Collection").locationTable[e]}function q(e,t){const n=u.store("puzzleList");t&&console.log("waow");let i=e.id<0;n.entries=[],n.sortedEntries=[],n.selectPuzzle(null),n.solveTarget=e?.solveTarget??null,n.finished=e.finished,n.sortBySolved=!i;for(let s=0;s<e.puzzles.length;s++){let r,o={locked:e.puzzleLocked[s],solved:e.puzzleSolved[s]};if(i){if(r=z.fromPuzzlesString(e.puzzles[s],null,s+1),v[r.genre].hidden&&!t||v[r.genre].evenMoreHidden)continue}else r=z.fromArchipelagoString(e.puzzles[s],e.baseSeed,s+1,o);n.entries.push(r)}n.resort()}function H(){const e=u.store("gamesaves");x=!1,e.connected=!1,w&&w.socket.connected&&(console.log("disconnecting from AP..."),w.socket.disconnect())}window.onmessage=function(e){if(!e.data[Symbol.iterator])return;let[t,...n]=e.data;if(t){let i=A[t];i?i(...n):(console.log("to puzzles.html:",e.data),console.warn("No handler found for message",e.data[0]))}},window.showPreferences=function(){S("showPreferences")},window.newPuzzle=function(){S("newPuzzle"),u.store("puzzleState").solved=!1},window.restartPuzzle=function(){S("restartPuzzle")},window.undoPuzzle=function(){S("undoPuzzle")},window.redoPuzzle=function(){S("redoPuzzle")},window.solvePuzzle=function(){S("solvePuzzle"),u.store("puzzleList").markSolved()},window.setPreset=function(e){S("setPreset",e)},window.savePuzzleData=O,window.loadPuzzleData=$,window.deletePuzzleData=async function(e){const t=u.store("gamesaves"),n=u.store("puzzleList");t.current&&(e??=n.current?.index),void 0!==e&&await t.current.deletePuzzleSave(e)},window.Alpine=u,window.store=u.store,window.client=w,window.Client=i,window.ArchipelagoPuzzle=z,window.syncAPStatus=T,window.SaveData=d,window.loadPuzzle=C,u.start()})();